## 文章索引
1、 <a href="#1改造react-domfb将推react-fire计划" >改造React DOM！FB将推React Fire计划</a><br/>
2、 <a href="#2前端要凉微软开源sketch2code草图秒变代码" >前端要凉？微软开源Sketch2Code，草图秒变代码</a><br/>
3、 <a href="#3文章-亲切照料下的领域驱动设计" >文章： “亲切照料”下的领域驱动设计</a><br/>
4、 <a href="#4文章-三个技巧将docker镜像体积减小90" >文章： 三个技巧，将Docker镜像体积减小90%</a><br/>
5、 <a href="#5文章-建设高效的devops平台跨组织协作而不是互怼" >文章： 建设高效的DevOps平台：跨组织协作而不是互怼</a><br/>
6、 <a href="#6哈希碰撞与生日攻击" >哈希碰撞与生日攻击</a><br/>
7、 <a href="#7金链盟中国区块链应用大赛" >金链盟中国区块链应用大赛</a><br/>
8、 <a href="#8go-111添加实验性的webassembly模块等特性" >Go 1.11添加实验性的WebAssembly、模块等特性</a><br/>
9、 <a href="#9cncf接纳harbor为沙箱项目" >CNCF接纳Harbor为沙箱项目</a><br/>
10、 <a href="#10preparing-your-app-for-ios-12-notifications" >Preparing Your App For iOS 12 Notifications</a><br/>
11、 <a href="#11浪潮成立inspur-devops-lab以应用开发和平台服务打造开发者生态" >浪潮成立Inspur DevOps Lab：以应用开发和平台服务打造开发者生态</a><br/><h1 id="#title_0" >1、改造React DOM！FB将推React Fire计划</h1>
Dan Abramov
[http://www.infoq.com/cn/news/2018/09/fb-reform-reactdom-react-fire?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global](http://www.infoq.com/cn/news/2018/09/fb-reform-reactdom-react-fire?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global)
<img src="http://www.infoq.com/styles/i/logo_bigger.jpg"/><p>今年，React团队主要关注的是React的基础改进。这项工作已经接近尾声，我们开始考虑React DOM的下一个主要版本应该是什么样子的。现在存在相当多已知问题，如果不对内部做一些大手术，有些问题很难甚至无法解决。我们希望能够撤销过去犯下的一些错误，这些错误导致了无穷无尽的后续修复和大量的技术债务。我们还希望删除事件系统中的一些抽象，这些抽象从React诞生之日起就几乎没有被动过，它们也是造成复杂性和臃肿的库文件的罪恶之源。我们把这项行动称为“React Fire”。</p> <i>By Dan Abramov</i> <i> Translated by 无明</i>
---------------
<h1 id="#title_1" >2、前端要凉？微软开源Sketch2Code，草图秒变代码</h1>
微软ML博客团队
[http://www.infoq.com/cn/news/2018/09/Ms-sketch2Code-opensourcing?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global](http://www.infoq.com/cn/news/2018/09/Ms-sketch2Code-opensourcing?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global)
<img src="http://www.infoq.com/styles/i/logo_bigger.jpg"/><p>Sketch2Code是一个基于Web的解决方案，使用AI将手绘的用户界面草图转换为可用的HTML代码。Sketch2Code由微软和Kabel、Spike Techniques合作开发。读者可以在GitHub上找到与Sketch2Code相关的代码、解决方案开发过程和其他详细信息。</p> <i>By 微软ML博客团队</i> <i> Translated by 无明</i>
---------------
<h1 id="#title_2" >3、文章： “亲切照料”下的领域驱动设计</h1>
Julie Lerman, Thomas Betts
[http://www.infoq.com/cn/articles/ddd-with-tlc?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global](http://www.infoq.com/cn/articles/ddd-with-tlc?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global)
<img src="https://res.infoq.com/articles/ddd-with-tlc/zh/smallimage/ddd-with-tlc-1535156092540-1535709526176.jpg"/><p>在2017年探索DDD会议上，Serial DDD倡导者Julie Lerman谈到了如何通过“温柔的爱护”进行领域驱动设计。InfoQ采访了Lerman，谈论了她如何向新客户介绍DDD并帮助他们取得成功。</p> <i>By Julie Lerman</i> <i> Translated by 无明</i>
---------------
<h1 id="#title_3" >4、文章： 三个技巧，将Docker镜像体积减小90%</h1>
Daniele Polencic
[http://www.infoq.com/cn/articles/3-simple-tricks-for-smaller-docker-images?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global](http://www.infoq.com/cn/articles/3-simple-tricks-for-smaller-docker-images?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global)
<img src="https://res.infoq.com/articles/3-simple-tricks-for-smaller-docker-images/zh/smallimage/logo-api-1510092752391-1535708194925.jpeg"/><p>本文介绍了三个技巧，可以将Docker镜像体积最多减少90%。</p> <i>By Daniele Polencic</i> <i> Translated by 无明</i>
---------------
<h1 id="#title_4" >5、文章： 建设高效的DevOps平台：跨组织协作而不是互怼</h1>
蒋刚毅
[http://www.infoq.com/cn/articles/build-high-performance-devops-platform?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global](http://www.infoq.com/cn/articles/build-high-performance-devops-platform?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global)
<img src="https://res.infoq.com/articles/build-high-performance-devops-platform/zh/smallimage/LOGO-1511697970292-1535707254844.jpeg"/><p>随着微服务架构与容器虚拟化技术的发展，DevOps 和敏捷文化已经深入人心，持续集成 / 持续交付的概念又重新回到了大家的视野。越来越多的公司开始使用持续集成的系统来解决频繁发布带来的质量问题；使用持续交付的工具来实现代码在不同环境上的自动部署。</p> <i>By 蒋刚毅</i>
---------------
<h1 id="#title_5" >6、哈希碰撞与生日攻击</h1>
阮一峰
[http://www.ruanyifeng.com/blog/2018/09/hash-collision-and-birthday-attack.html](http://www.ruanyifeng.com/blog/2018/09/hash-collision-and-birthday-attack.html)
<h2>一、哈希碰撞是什么？</h2>

<p>所谓哈希（hash），就是将不同的输入映射成独一无二的、固定长度的值（又称"哈希值"）。它是最常见的软件运算之一。</p>

        <p>如果不同的输入得到了同一个哈希值，就发生了"哈希碰撞"（collision）。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090510.png" alt="" title="" /></p>

<p>举例来说，很多网络服务会使用哈希函数，产生一个 token，标识用户的身份和权限。</p>

<blockquote><pre><code class="language-bash">
AFGG2piXh0ht6dmXUxqv4nA1PU120r0yMAQhuc13i8
</code></pre></blockquote>

<p>上面这个字符串就是一个哈希值。如果两个不同的用户，得到了同样的 token，就发生了哈希碰撞。服务器将把这两个用户视为同一个人，这意味着，用户 B 可以读取和更改用户 A 的信息，这无疑带来了很大的安全隐患。</p>

<p>黑客攻击的一种方法，就是设法制造"哈希碰撞"，然后入侵系统，窃取信息。</p>

<h2>二、如何防止哈希碰撞？</h2>

<p>防止哈希碰撞的最有效方法，就是扩大哈希值的取值空间。</p>

<p>16个二进制位的哈希值，产生碰撞的可能性是 65536 分之一。也就是说，如果有65537个用户，就一定会产生碰撞。哈希值的长度扩大到32个二进制位，碰撞的可能性就会下降到 4,294,967,296 分之一。</p>

<p>更长的哈希值意味着更大的存储空间、更多的计算，将影响性能和成本。开发者必须做出抉择，在安全与成本之间找到平衡。</p>

<p>下面就介绍，如何在满足安全要求的前提下，找出哈希值的最短长度。</p>

<h2>三、生日攻击</h2>

<p>哈希碰撞的概率取决于两个因素（假设哈希函数是可靠的，每个值的生成概率都相同）。</p>

<blockquote>
  <ul>
<li>取值空间的大小（即哈希值的长度）</li>
<li>整个生命周期中，哈希值的计算次数</li>
</ul>
</blockquote>

<p>这个问题在数学上早有原型，叫做""（birthday problem）：一个班级需要有多少人，才能保证每个同学的生日都不一样？</p>

<p>答案很出人意料。如果至少两个同学生日相同的概率不超过5%，那么这个班只能有7个人。事实上，一个23人的班级有50%的概率，至少两个同学生日相同；50人班级有97%的概率，70人的班级则是99.9%的概率（计算方法见后文）。</p>

<p>这意味着，如果哈希值的取值空间是365，只要计算23个哈希值，就有50%的可能产生碰撞。也就是说，哈希碰撞的可能性，远比想象的高。实际上，有一个近似的公式。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090509.png" alt="" title="" /></p>

<p>上面公式可以算出，50% 的哈希碰撞概率所需要的计算次数，N 表示哈希的取值空间。生日问题的 N 就是365，算出来是 23.9。这个公式告诉我们，哈希碰撞所需耗费的计算次数，跟取值空间的平方根是一个数量级。</p>

<p>这种利用哈希空间不足够大，而制造碰撞的攻击方法，就被称为生日攻击（birthday attack）。</p>

<h2>四、数学推导</h2>

<p>这一节给出生日攻击的数学推导。</p>

<p>至少两个人生日相同的概率，可以先算出所有人生日互不相同的概率，再用 1 减去这个概率。</p>

<p>我们把这个问题设想成，每个人排队依次进入一个房间。第一个进入房间的人，与房间里已有的人（0人），生日都不相同的概率是<code>365/365</code>；第二个进入房间的人，生日独一无二的概率是<code>364/365</code>；第三个人是<code>363/365</code>，以此类推。</p>

<p>因此，所有人的生日都不相同的概率，就是下面的公式。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090501.png" alt="" title="" /></p>

<p>上面公式的 n 表示进入房间的人数。可以看出，进入房间的人越多，生日互不相同的概率就越小。</p>

<p>这个公式可以推导成下面的形式。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090502.png" alt="" title="" /></p>

<p>那么，至少有两个人生日相同的概率，就是 1 减去上面的公式。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090503.png" alt="" title="" /></p>

<h2>五、哈希碰撞的公式</h2>

<p>上面的公式，可以进一步推导成一般性的、便于计算的形式。</p>

<p>根据泰勒公式，指数函数 e<sup>x</sup>  可以用多项式展开。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090504.png" alt="" title="" /></p>

<p>如果 x 是一个极小的值，那么上面的公式近似等于下面的形式。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090505.png" alt="" title="" /></p>

<p>现在把生日问题的<code>1/365</code>代入。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090506.png" alt="" title="" /></p>

<p>因此，生日问题的概率公式，变成下面这样。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090507.png" alt="" title="" /></p>

<p>假设 d 为取值空间（生日问题里是 365），就得到了一般化公式。</p>

<p><img src="https://www.wangbase.com/blogimg/asset/201809/bg2018090508.png" alt="" title="" /></p>

<p>上面就是哈希碰撞概率的公式。</p>

<h2>六、应用</h2>

<p>上面的公式写成函数。</p>

<blockquote><pre><code class="language-javascript">
const calculate = (d, n) => {
  const exponent = (-n * (n - 1)) / (2 * d)
  return 1 - Math.E ** exponent;
}

calculate(365, 23) // 0.5000017521827107
calculate(365, 50) // 0.9651312540863107
calculate(365, 70) // 0.9986618113807388
</code></pre></blockquote>

<p>一般来说，哈希值由大小写字母和阿拉伯数字构成，一共62个字符（10 + 26 + 26）。如果哈希值只有三个字符的长度（比如<code>abc</code>），取值空间就是 <code>62 ^ 3 = 238,328</code>，那么10000次计算导致的哈希碰撞概率是100%。</p>

<blockquote><pre><code class="language-javascript">
calculate(62 ** 3, 10000) // 1
</code></pre></blockquote>

<p>哈希值的长度增加到5个字符（比如<code>abcde</code>），碰撞的概率就下降到5.3%。</p>

<blockquote><pre><code class="language-javascript">
calculate(62 ** 5, 10000) // 0.05310946204730993
</code></pre></blockquote>

<p>现在有一家公司，它的 API 每秒会收到100万个请求，每个请求都会生成一个哈希值，假定这个 API 会使用10年。那么，大约一共会计算300万亿次哈希。能够接受的哈希碰撞概率是1000亿分之一（即每天发生一次哈希碰撞），请问哈希字符串最少需要多少个字符？</p>

<p>根据上面的公式倒推，就会知道哈希值的最短长度是22个字符（比如<code>BwQ1W6soXkA1PU120r0yMA</code>），计算过程略。</p>

<p>22个字符的哈希值，就能保证300万亿次计算里面，只有1000亿分之一的概率发生碰撞。常用的 SHA256 哈希函数产生的是64个字符的哈希值，可想而知，发生碰撞的概率有多低。</p>

<h2>七、参考链接</h2>

<ul>
<li>, by Sam Corcos</li>
<li>, by Wikipedia</li>
<li>, by Wikipedia</li>
</ul>

<p>（完）</p>

        <div style="color:#556677;line-height:160%;padding:0.3em 0.5em;border:1px solid #d3d3d3;margin:1em;background-color:#AAD2F0;-moz-border-radius: 10px;-webkit-border-radius:10px;border-radius: 10px;"><h3>文档信息</h3>
<ul>
<li>版权声明：自由转载-非商用-非衍生-保持署名（）</li>
<li>发表日期： <abbr class="published" title="2018-09-05T20:41:28+08:00">2018年9月 5日</abbr></li>
<li>更多内容：   » 
 
</li>
<li>文集：</li>
<li>社交媒体：</li>

</ul></div>        
        <div style="color:#556677;line-height:160%;padding:0.3em 0.5em;margin:1em;-moz-border-radius: 10px;-webkit-border-radius:10px;border-radius: 10px;"></div>
---------------
<h1 id="#title_6" >7、金链盟中国区块链应用大赛</h1>
李坷
[http://www.infoq.com/cn/news/2018/09/Fisco-bcos-compitition?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global](http://www.infoq.com/cn/news/2018/09/Fisco-bcos-compitition?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global)
<img src="http://www.infoq.com/styles/i/logo_bigger.jpg"/><p>2018 年金链盟中国区块链应用大赛，开始向全国各企业和团队征集应用案例啦！想参加的你们，看这篇文章就够了。</p> <i>By 李坷</i>
---------------
<h1 id="#title_7" >8、Go 1.11添加实验性的WebAssembly、模块等特性</h1>
Sergio De Simone
[http://www.infoq.com/cn/news/2018/09/golang-1.11-modules-we?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global](http://www.infoq.com/cn/news/2018/09/golang-1.11-modules-we?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global)
<img src="http://www.infoq.com/styles/i/logo_bigger.jpg"/><p>Go 1.11的两个主要特性是WebAssembly和模块，不过这两个特性依然处于实验性阶段。</p> <i>By Sergio De Simone</i> <i> Translated by 张卫滨 </i>
---------------
<h1 id="#title_8" >9、CNCF接纳Harbor为沙箱项目</h1>
Eldert Grootenboer
[http://www.infoq.com/cn/news/2018/09/cncf-harbor-registry?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global](http://www.infoq.com/cn/news/2018/09/cncf-harbor-registry?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global)
<img src="http://www.infoq.com/styles/i/logo_bigger.jpg"/><p>CNCF（云原生计算基金会，Cloud Native Computing Foundation）宣布接纳Harbor为其沙箱项目（Sandbox）。Harbor是一种容器镜像的云原生仓库（Registry），提供容器的存储、签名和扫描等。它添加了安全、身份和管理等功能，扩展了操作Docker内容的工具集Docker Distribution。</p> <i>By Eldert Grootenboer</i> <i> Translated by 盖磊</i>
---------------
<h1 id="#title_9" >10、Preparing Your App For iOS 12 Notifications</h1>
Kaya Thomas
[https://www.smashingmagazine.com/2018/09/preparing-your-app-for-ios-12-notifications/](https://www.smashingmagazine.com/2018/09/preparing-your-app-for-ios-12-notifications/)
<html>
            <head>
              <meta charset="utf-8">
              <link rel="canonical" href="https://www.smashingmagazine.com/2018/09/preparing-your-app-for-ios-12-notifications/" />
              <title>Preparing Your App For iOS 12 Notifications</title>
            </head>
            <body>
              <article>
                <header>
                  <h1>Preparing Your App For iOS 12 Notifications</h1>
                  
                    
                    <address>Kaya Thomas</address>
                  
                  <time datetime="2018-09-05T13:30:35&#43;02:00" class="op-published">2018-09-05T13:30:35+02:00</time>
                  <time datetime="2018-09-05T11:52:50&#43;00:00" class="op-modified">2018-09-05T11:52:50+00:00</time>
                </header>
                

<p>In 2016, Apple announced a new extension that will allow developers to better customize their push and local notifications called the <code>UNNotificationContentExtension</code>. The extension gets triggered when a user long presses or 3D touches on a notification whenever it is delivered to the phone or from the lock/home screen. In the content extension, developers can use a view controller to structure the UI of their notification, but there was no user interaction enabled within the view controller &mdash; until now. With the release of iOS 12 and XCode 10, <strong>the view controller in the content extension now enables user interaction</strong> which means notifications will become even more powerful and customizable.</p>

<p>At WWDC 2018, Apple also announced several changes to notification settings and how they appear on the home screen. In an effort to make users more aware of how they are using apps and allowing more user control of their app usage, there is a new notification setting called “Deliver Quietly.” Users can set your app to <em>Delivery Quietly</em> from the Notification Center, which means they will not receive banners or sound notifications from your app, but they will appear in the Notification Center. Apple using an in-house algorithm, which presumably tracks often you interact with notifications, will also <strong>ask users if they still want to receive notifications from particular apps</strong> and encourage you to turn on <em>Deliver Quietly</em> or turn them off completely.</p>

<p>Notifications are getting a big refresh in iOS 12, and I&rsquo;ve only scratched the surface. In the rest of this article, we’ll go over the rest of the new notification features coming to iOS 12 and how you can implement them in your own app.</p>

<p><strong>Recommended reading</strong>: <em></em></p>

<h3 id="remote-vs-local-notifications">Remote vs Local Notifications</h3>

<p>There are two ways to send push notifications to a device: remotely or locally. To send notifications remotely, you need a server that can send JSON payloads to Apple’s Push Notification Service. Along with a payload, you also need to send the device token and any other authentication certificate or tokens that verify your server is allowed to send the push notification through Apple. For this article, we focus on local notifications which do not need a separate server. Local notifications are requested and sent through the <code>UNUserNotificationCenter</code>. We’ll go over later how specifically to make the request for a local notification.</p>

<p>In order to send a notification, you first need to get permission from the user on <strong>whether or not they want you to send them notifications</strong>. With the release of iOS 12, there are a lot of changes to notification settings and permissions so let’s break it down. To test out any of the code yourself, make sure you have the Xcode 10 beta installed.</p>



  <aside class="product-panel product-panel__tilted product-panel--book" data-audience="non-subscriber">
    <div class="container product-panel--book__container">
      <div class="panel__description panel__description--book">
    <p>Getting the process <em>just</em> right ain't an easy task. That's why we've set up <strong>'this-is-how-I-work'-sessions</strong> — with smart cookies sharing what works really well for them. A part of the , of course.</p>
      <a href="https://smashed.by/casestudypanelmembership" class="btn btn--green btn--large">
        Explore features&nbsp;→
      </a>
      </div>
      <div class="panel__image panel__image--book">
        <a href="https://smashed.by/casestudypanelmembership" class="books__book__image">
        <div class="books__book__img">
          <img src="https://www.smashingmagazine.com/images/smashing-cat/cat-scubadiving-panel.svg" alt="Smashing TV, with live sessions for professional designers and developers." width="310" height="400">
        </div>
      </a>
      </div>
    </div>
  </aside>




<h3 id="notification-settings-and-permissions">Notification Settings And Permissions</h3>

<h4 id="deliver-quietly">Deliver Quietly</h4>

<p><em>Delivery Quietly</em> is Apple’s attempt to allow users more control over the noise they may receive from notifications. Instead of going into the settings app and looking for the app whose notification settings you want to change, you can now change the setting directly from the notification. This means that a lot more users may turn off notifications for your app or just delivery them quietly which means the app will get badged and notifications only show up in the Notification Center. If your app has its own custom notification settings, Apple is allowing you to link directly to that screen from the settings management view pictured below.</p>











<figure >
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/015ae8de-f1c1-460e-82c4-303f9339246a/deliverquietly.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/983fa66d-c378-48b6-a2e1-4aab6c720733/app-ios-12-notifications-deliverquietly.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/983fa66d-c378-48b6-a2e1-4aab6c720733/app-ios-12-notifications-deliverquietly.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/983fa66d-c378-48b6-a2e1-4aab6c720733/app-ios-12-notifications-deliverquietly.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/983fa66d-c378-48b6-a2e1-4aab6c720733/app-ios-12-notifications-deliverquietly.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/983fa66d-c378-48b6-a2e1-4aab6c720733/app-ios-12-notifications-deliverquietly.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/983fa66d-c378-48b6-a2e1-4aab6c720733/app-ios-12-notifications-deliverquietly.png"
			sizes="100vw"
			alt="iPhone 8 Plus shown with Manage selected from notification which brings up the Deliver Quietly and Turn Off options."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Delivery quietly feature. ()
		</figcaption>
	
</figure>


<p>In order to link to your custom notification setting screen, you must set <code>providesAppNotificationSettings</code> as a <code>UNAuthorizationOption</code> when you are requesting notification permissions in the app delegate.</p>

<p>In <code>didFinishLaunchingWithOptions</code>, add the following code:</p>

<pre class="break-out"><code class="language-javascript">UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .badge, .sound, .providesAppNotificationSettings]) { ... }
</code></pre>

<p>When you do this, you’ll now see your custom notification settings in two places:</p>

<ul>
<li>If the user selects <code>Turn Off</code> when they go to manage settings directly from the notification;</li>
<li>In the notification settings within the system’s Settings app.</li>
</ul>











<figure >
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e6fba0db-8684-420c-8d3d-414aaf80ce07/turnoffnotifications.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/c4ee20c1-ca99-419b-bfa4-4f5ebbffabf3/app-ios-12-notifications-turnoffnotifications.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/c4ee20c1-ca99-419b-bfa4-4f5ebbffabf3/app-ios-12-notifications-turnoffnotifications.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/c4ee20c1-ca99-419b-bfa4-4f5ebbffabf3/app-ios-12-notifications-turnoffnotifications.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/c4ee20c1-ca99-419b-bfa4-4f5ebbffabf3/app-ios-12-notifications-turnoffnotifications.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/c4ee20c1-ca99-419b-bfa4-4f5ebbffabf3/app-ios-12-notifications-turnoffnotifications.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/c4ee20c1-ca99-419b-bfa4-4f5ebbffabf3/app-ios-12-notifications-turnoffnotifications.png"
			sizes="100vw"
			alt="iPhone 8 Plus shown with Turn Off selected from notification which brings up the Turn Off All Notifications and Configure in NotificationTester options."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Deep link to to custom notification settings for NotificationTester from notification in the Notification Center. ()
		</figcaption>
	
</figure>












<figure >
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/658ab8e1-d0f1-46b2-b092-7f8ed643f4e0/systemnotificationsettings.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/45e51038-8365-4064-ab03-feee8cc56eef/app-ios-12-notifications-systemnotificationsettings.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/45e51038-8365-4064-ab03-feee8cc56eef/app-ios-12-notifications-systemnotificationsettings.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/45e51038-8365-4064-ab03-feee8cc56eef/app-ios-12-notifications-systemnotificationsettings.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/45e51038-8365-4064-ab03-feee8cc56eef/app-ios-12-notifications-systemnotificationsettings.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/45e51038-8365-4064-ab03-feee8cc56eef/app-ios-12-notifications-systemnotificationsettings.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/45e51038-8365-4064-ab03-feee8cc56eef/app-ios-12-notifications-systemnotificationsettings.png"
			sizes="100vw"
			alt="iPhone 8 Plus shown with system Settings app open with Notifications screen for NotificationTester app."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Deep link to custom notification settings for NotificationTester from system’s Settings app. ()
		</figcaption>
	
</figure>


<p>You also have to make sure to handle the callback for when the user selects on either way to get to your notification settings. Your app delegate or an extension of your app delegate has to conform to the protocol <code>UNUserNotificationCenterDelegate</code> so you can then implement the following callback method:</p>

<pre class="break-out"><code class="language-javascript">func userNotificationCenter(_ center: UNUserNotificationCenter, openSettingsFor notification: UNNotification?) {
    let navController = self.window?.rootViewController as! UINavigationController
    let notificationSettingsVC = NotificationSettingsViewController()
    navController.pushViewController(notificationSettingsVC, animated: true)
}</code></pre>

<p>Another new <code>UNAuthorizationOption</code> is provisional authorization. If you don&rsquo;t mind your notifications being delivered quietly, you can set add <code>.provisional</code> to your authorization options as shown below. This means that you don&rsquo;t have to prompt the user to allow notifications &mdash; the notifications will still show up in the Notification Center.</p>

<pre class="break-out"><code class="language-javascript">UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .badge, .provisional]) { ... }
</code></pre>

<p>So now that you&rsquo;ve determined how to request permission from the user to deliver notifications and how to navigate users to your own customized settings view, let’s go more into more detail about the actual notifications.</p>

<h3 id="sending-grouped-notifications">Sending Grouped Notifications</h3>

<p>Before we get into the customization of the UI of a notification, let’s go over how to make the request for a local notification. First, you have to register any <code>UNNotificationCategory</code>, which are like templates for the notifications you want to send. Any notification set to a particular category will inherit any actions or options that were registered with that category. After you&rsquo;ve requested permission to send notifications in <code>didFinishLaunchingWithOptions</code>, you can register your categories in the same method.</p>

<pre class="break-out"><code class="language-javascript">let hiddenPreviewsPlaceholder = "%u new podcast episodes available"
let summaryFormat = "%u more episodes of %@"
let podcastCategory = UNNotificationCategory(identifier: "podcast", actions: [], intentIdentifiers: [], hiddenPreviewsBodyPlaceholder: hiddenPreviewsPlaceholder, categorySummaryFormat: summaryFormat, options: [])
UNUserNotificationCenter.current().setNotificationCategories([podcastCategory])
</code></pre>

<p>In the above code, I start by initiating two variables:</p>

<ul>
<li><code>hiddenPreviewsPlaceholder</code><br />
This placeholder is used in case the user has &ldquo;Show Previews&rdquo; off for your app; if we don&rsquo;t have a placeholder there, your notification will show with only &ldquo;Notification&rdquo; also the text.</li>
<li><code>summaryFormat</code><br />
This string is new for iOS 12 and coincides with the new feature called “Group Notifications” that will help the Notification Center look a lot cleaner. All notifications will show up in stacks which will be either representing all notifications from the app or specific groups that the developer has set for there app.</li>
</ul>

<p>The code below shows how we associate a notification with a group.</p>

<pre class="break-out"><code class="language-javascript">@objc func sendPodcastNotification(for podcastName: String) {
let content = UNMutableNotificationContent()
content.body = "Introducing Season 7"
content.title = "New episode of \(podcastName):"
content.threadIdentifier = podcastName.lowercased()
content.summaryArgument = podcastName
content.categoryIdentifier = NotificationCategoryType.podcast.rawValue
sendNotification(with: content)
}
</code></pre>

<p>For now, I&rsquo;ve hardcoded the text of the notification just for the example. The <code>threadIdentifier</code> is what creates the groups that we show as stacks in the Notification Center. In this example, I want the notifications grouped by podcast so each notification you get is separated by what podcast it’s associated with. The <code>summaryArgument</code> matches back to our <code>categorySummaryFormat</code> we set in the app delegate. In this case, we want the string for the format: <code>&quot;%u more episodes of %@&quot;</code> to be the podcast name. Lastly, we have to set the category identifier to ensure the notification has the template we set in the app delegate.</p>

<pre class="break-out"><code class="language-javascript">func sendNotification(for category: String, with content: UNNotificationContent) {
let uuid = UUID().uuidString
let trigger = UNTimeIntervalNotificationTrigger(timeInterval: 5, repeats: false)
let request = UNNotificationRequest(identifier: uuid, content: content, trigger: trigger)
UNUserNotificationCenter.current().add(request, withCompletionHandler: nil)
}
</code></pre>

<p>The above method is how we request the notification to be sent to the device. The identifier for the request is just a random unique string; the content is passed in and we create the content in our <code>sendPodcastNotification</code> method, and lastly, the trigger is when you want the notification to send. If you want the notification to send immediately, you can set that parameter to nil.</p>











<figure >
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a4289cd7-c8c7-4699-be0c-099dfe26963d/groupednotifications.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/caa0866c-c0d0-4d65-b121-ef64a001eb3f/app-ios-12-notifications-groupednotifications.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/caa0866c-c0d0-4d65-b121-ef64a001eb3f/app-ios-12-notifications-groupednotifications.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/caa0866c-c0d0-4d65-b121-ef64a001eb3f/app-ios-12-notifications-groupednotifications.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/caa0866c-c0d0-4d65-b121-ef64a001eb3f/app-ios-12-notifications-groupednotifications.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/caa0866c-c0d0-4d65-b121-ef64a001eb3f/app-ios-12-notifications-groupednotifications.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/caa0866c-c0d0-4d65-b121-ef64a001eb3f/app-ios-12-notifications-groupednotifications.png"
			sizes="100vw"
			alt="iPhone 8 Plus lock screen shown with a grouped notification stack from Notification Tester app."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Grouped notifications for NotificationTester. ()
		</figcaption>
	
</figure>












<figure >
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/081cfe45-005b-4c63-8a4d-fcae440b96ad/hiddenpreviewgroup.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9cc3d6eb-5da6-4067-b091-1071009a9670/app-ios-12-notifications-hiddenpreviewgroup.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9cc3d6eb-5da6-4067-b091-1071009a9670/app-ios-12-notifications-hiddenpreviewgroup.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9cc3d6eb-5da6-4067-b091-1071009a9670/app-ios-12-notifications-hiddenpreviewgroup.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9cc3d6eb-5da6-4067-b091-1071009a9670/app-ios-12-notifications-hiddenpreviewgroup.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9cc3d6eb-5da6-4067-b091-1071009a9670/app-ios-12-notifications-hiddenpreviewgroup.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9cc3d6eb-5da6-4067-b091-1071009a9670/app-ios-12-notifications-hiddenpreviewgroup.png"
			sizes="100vw"
			alt="iPhone 8 Plus lock screen shown with a grouped notification stack from Notification Tester app that has hidden content."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Notification grouped with previews turned off. ()
		</figcaption>
	
</figure>


<p>Using the methods we&rsquo;ve described above, here’s the result on the simulator. I have a button that has the <code>sendPodcastNotification</code> method as a target. I tapped the button three times to have the notifications sent to the device. In the first photo, I have “Show Previews” set to “Always” so I see the podcast and the name of the new episodes along with the summary that shows I have two more new episodes to check out. When “Show Previews” is set to “Never,” the result is the second image above. The user won&rsquo;t see which podcast it is to respect the “No Preview” setting, but they can still see that I have three new episodes to check out.</p>

<div class="sponsors__wide-place"></div>




<h3 id="notification-content-extension">Notification Content Extension</h3>

<p>Now that we understand how to set our notification categories and make the request for them to be sent, we can go over how to customize the look of the notification using the Notification Service and Notification Content extensions. The Notification Service extension allows you to edit the notification content and download any attachments in your notification like images, audio or video files. The Notification Content extension contains a view controller and storyboard that allows you to customize the look of your notification as well as handle any user interaction within the view controller or taps on notification actions.</p>

<p>To add these extensions to your app go File&nbsp;&rarr; &nbsp;New&nbsp;&rarr; &nbsp;Target.</p>











<figure class="article__image break-out">
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e944c138-1386-4050-99e1-e240d1e1cba9/template-new-target.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e944c138-1386-4050-99e1-e240d1e1cba9/template-new-target.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e944c138-1386-4050-99e1-e240d1e1cba9/template-new-target.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e944c138-1386-4050-99e1-e240d1e1cba9/template-new-target.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e944c138-1386-4050-99e1-e240d1e1cba9/template-new-target.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e944c138-1386-4050-99e1-e240d1e1cba9/template-new-target.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e944c138-1386-4050-99e1-e240d1e1cba9/template-new-target.png"
			sizes="100vw"
			alt="Xcode shown after selecting from menu to add a new target, Notification Content Extension is highlighted."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Adding new target to app for the Notification Content Extension. ()
		</figcaption>
	
</figure>


<p>You can only add them one at a time, so name your extension and repeat the process to add the other. If a pop-up appears asking you to activate your new scheme, click the “Activate” button to set it up for debugging.</p>

<p>For the purpose of this tutorial, we will be focusing on the Notification Content Extension. For local notifications, we can include the attachments in the request, which we’ll go over later.</p>

<p>First, go to the <em>Info.plist</em> file in the Notification Content Extension target.</p>











<figure class="article__image break-out">
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d26c3dca-2733-4e91-941c-b6e4f1bff676/plistfile.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d26c3dca-2733-4e91-941c-b6e4f1bff676/plistfile.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d26c3dca-2733-4e91-941c-b6e4f1bff676/plistfile.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d26c3dca-2733-4e91-941c-b6e4f1bff676/plistfile.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d26c3dca-2733-4e91-941c-b6e4f1bff676/plistfile.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d26c3dca-2733-4e91-941c-b6e4f1bff676/plistfile.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d26c3dca-2733-4e91-941c-b6e4f1bff676/plistfile.png"
			sizes="100vw"
			alt="Info.plist file for Notification Content Extension shown in Xcode."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Info.plist for the Notification Content Extension. ()
		</figcaption>
	
</figure>


<p>The following attributes are required:</p>

<ul>
<li><code>UNNotificationExtensionCategory</code><br />
A string value equal to the notification category which we created and set in the app delegate. This will let the content extension know which notification you want to have custom UI for.</li>
<li><code>UNNotificationExtensionInitialContentSizeRatio</code><br />
A number between 0 and 1 which determines the aspect ratio of your UI. The default value is 1 which will allow your interface to have its total height equal to its width.</li>
</ul>

<p>I&rsquo;ve also set <code>UNNotificationExtensionDefaultContentHidden</code> to “YES” so that the default notification does not show when the content extension is running.</p>

<p>You can use the storyboard to set up your view or create the UI programmatically in the view controller. For this example I&rsquo;ve set up my storyboard with an image view which will show the podcast logo, two labels for the title and body of the notification content, and a “Like” button which will show a heart image.</p>

<p>Now, in order to get the image showing for the podcast logo and the button, we need to go back to our notification request:</p>

<pre class="break-out"><code class="language-javascript">guard let pathUrlForPodcastImg = Bundle.main.url(forResource: "startup", withExtension: "jpg") else { return }
let imgAttachment = try! UNNotificationAttachment(identifier: "image", url: pathUrlForPodcastImg, options: nil)

guard let pathUrlForButtonNormal = Bundle.main.url(forResource: "heart-outline", withExtension: "png") else { return }
let buttonNormalStateImgAtt = try! UNNotificationAttachment(identifier: "button-normal-image", url: pathUrlForButtonNormal, options: nil)

guard let pathUrlForButtonHighlighted = Bundle.main.url(forResource: "heart-filled", withExtension: "png") else { return }
let buttonHighlightStateImgAtt = try! UNNotificationAttachment(identifier: "button-highlight-image", url: pathUrlForButtonHighlighted, options: nil)

content.attachments = [imgAttachment, buttonNormalStateImgAtt, buttonHighlightStateImgAtt]
</code></pre>

<p>I added a folder in my project that contains all the images we need for the notification so we can access them through the main bundle.</p>











<figure >
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a0cdf5dd-3c0e-4ae1-a963-23d6da6ac464/files.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a0cdf5dd-3c0e-4ae1-a963-23d6da6ac464/files.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a0cdf5dd-3c0e-4ae1-a963-23d6da6ac464/files.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a0cdf5dd-3c0e-4ae1-a963-23d6da6ac464/files.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a0cdf5dd-3c0e-4ae1-a963-23d6da6ac464/files.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a0cdf5dd-3c0e-4ae1-a963-23d6da6ac464/files.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a0cdf5dd-3c0e-4ae1-a963-23d6da6ac464/files.png"
			sizes="100vw"
			alt="Project navigator shown in Xcode."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Xcode project navigator. ()
		</figcaption>
	
</figure>


<p>For each image, we get the file path and use that to create a <code>UNNotificationAttachment</code>. Added that to our notification content allows us to access the images in the Notification Content Extension in the <code>didReceive</code> method shown below.</p>

<pre class="break-out"><code class="language-javascript">func didReceive(_ notification: UNNotification) {
self.newEpisodeLabel.text = notification.request.content.title
self.episodeNameLabel.text = notification.request.content.body

let imgAttachment = notification.request.content.attachments[0]
let buttonNormalStateAtt = notification.request.content.attachments[1]
let buttonHighlightStateAtt = notification.request.content.attachments[2]

guard let imageData = NSData(contentsOf: imgAttachment.url), let buttonNormalStateImgData = NSData(contentsOf: buttonNormalStateAtt.url), let buttonHighlightStateImgData = NSData(contentsOf: buttonHighlightStateAtt.url) else { return }

let image = UIImage(data: imageData as Data)
let buttonNormalStateImg = UIImage(data: buttonNormalStateImgData as Data)?.withRenderingMode(.alwaysOriginal)
let buttonHighlightStateImg = UIImage(data: buttonHighlightStateImgData as Data)?.withRenderingMode(.alwaysOriginal)

imageView.image = image
likeButton.setImage(buttonNormalStateImg, for: .normal)
likeButton.setImage(buttonHighlightStateImg, for: .selected)
}
</code></pre>

<p>Now we can use the file path URLs we set in the request to grab the data for the URL and turn them into images. Notice that I have two different images for the different button states which will allow us to update the UI for user interaction. When I run the app and send the request, here’s what the notification looks like:</p>











<figure >
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/4bd578f0-2a67-4b47-96ce-d2091ce585dc/customizednotification.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/038aa952-9159-4d4f-af52-b007190a918f/app-ios-12-notifications-customizednotification.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/038aa952-9159-4d4f-af52-b007190a918f/app-ios-12-notifications-customizednotification.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/038aa952-9159-4d4f-af52-b007190a918f/app-ios-12-notifications-customizednotification.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/038aa952-9159-4d4f-af52-b007190a918f/app-ios-12-notifications-customizednotification.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/038aa952-9159-4d4f-af52-b007190a918f/app-ios-12-notifications-customizednotification.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/038aa952-9159-4d4f-af52-b007190a918f/app-ios-12-notifications-customizednotification.png"
			sizes="100vw"
			alt="iPhone 8 Plus shown with custom notification loaded after force touching the notification."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Content extension loaded for NotificationTester app. ()
		</figcaption>
	
</figure>


<p>Everything I&rsquo;ve mentioned so far in relation to the content extension isn&rsquo;t new in iOS 12, so let’s dig into the two new features: <strong>User Interaction</strong> and <strong>Dynamic Actions</strong>. When the content extension was first added in iOS 10, there was no ability to capture user touch within a notification, but now we can register UIControl events and respond when the user interacts with a UI element.</p>

<p>For this example, we want to show the user that the “Like” button has been selected or unselected. We already set the images for the <code>.normal</code> and <code>.selected</code> states, so now we just need to add a target for the UIButton so we can update the selected state.</p>

<pre class="break-out"><code class="language-javascript">override func viewDidLoad() {
super.viewDidLoad()
// Do any required interface initialization here.
likeButton.addTarget(self, action: #selector(likeButtonTapped(sender:)), for: .touchUpInside)
}</code></pre>

<pre class="break-out"><code class="language-javascript">@objc func likeButtonTapped(sender: UIButton) {
likeButton.isSelected = !sender.isSelected
}</code></pre>

<p>Now with the above code we get the following behavior:</p>

<figure>)</figcaption></figure>

<p>In the selector method <code>likeButtonTapped</code>, we could also add any logic for saving the liked state in User Defaults or the Keychain, so we have access to it in our main application.</p>

<p>Notification actions have existed since iOS 10, but once you click on them, usually the user will be rerouted to the main application or the content extension is dismissed. Now in iOS 12, we can update the list of notification actions that are shown in response to which action the user selects.</p>

<p>First, let’s go back to our app delegate where we create our notification categories so we can add some actions to our podcast category.</p>

<pre class="break-out"><code class="language-javascript">let playAction = UNNotificationAction(identifier: "play-action", title: "Play", options: [])
let queueAction = UNNotificationAction(identifier: "queue-action", title: "Queue Next", options: [])
let podcastCategory = UNNotificationCategory(identifier: "podcast", actions: [playAction, queueAction], intentIdentifiers: [], hiddenPreviewsBodyPlaceholder: hiddenPreviewsPlaceholder, categorySummaryFormat: summaryFormat, options: [])
</code></pre>

<p>Now when we run the app and send a notification, we see the following actions shown below:</p>











<figure >
	<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/bf7a6884-20f0-4a22-b934-56bf2bb4d3cf/quickactions.png">
		<img
			srcset="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/bf7a6884-20f0-4a22-b934-56bf2bb4d3cf/quickactions.png 400w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_800/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/bf7a6884-20f0-4a22-b934-56bf2bb4d3cf/quickactions.png 800w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1200/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/bf7a6884-20f0-4a22-b934-56bf2bb4d3cf/quickactions.png 1200w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_1600/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/bf7a6884-20f0-4a22-b934-56bf2bb4d3cf/quickactions.png 1600w,
			        https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_2000/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/bf7a6884-20f0-4a22-b934-56bf2bb4d3cf/quickactions.png 2000w"
			src="https://res.cloudinary.com/indysigner/image/fetch/f_auto,q_auto/w_400/https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/bf7a6884-20f0-4a22-b934-56bf2bb4d3cf/quickactions.png"
			sizes="100vw"
			alt="iPhone 8 Plus with custom notification loaded with an options to Play or Add to Queue."
		/>
	</a>

	
		<figcaption class="op-vertical-bottom">
			Notification quick actions. ()
		</figcaption>
	
</figure>


<p>When the user selects “Play,” we want the action to be updated to “Pause.” If they select “Queue Next,” we want that action to be updated to “Remove from Queue.” We can do this in our <code>didReceive</code> method in the Notification Content Extension’s view controller.</p>

<pre class="break-out"><code class="language-javascript">func didReceive(_ response: UNNotificationResponse, completionHandler completion:
(UNNotificationContentExtensionResponseOption) -> Void) {
guard let currentActions = extensionContext?.notificationActions else { return }

if response.actionIdentifier == "play-action" {
let pauseAction = UNNotificationAction(identifier: "pause-action", title: "Pause", options: [])
let otherAction = currentActions[1]
let newActions = [pauseAction, otherAction]
extensionContext?.notificationActions = newActions

} else if response.actionIdentifier == "queue-action" {
let removeAction = UNNotificationAction(identifier: "remove-action", title: "Remove from Queue", options: [])
let otherAction = currentActions[0]
let newActions = [otherAction, removeAction]
extensionContext?.notificationActions = newActions

}  else if response.actionIdentifier == "pause-action" {
let playAction = UNNotificationAction(identifier: "play-action", title: "Play", options: [])
let otherAction = currentActions[1]
let newActions = [playAction, otherAction]
extensionContext?.notificationActions = newActions

} else if response.actionIdentifier == "remove-action" {
let queueAction = UNNotificationAction(identifier: "queue-action", title: "Queue Next", options: [])
let otherAction = currentActions[0]
let newActions = [otherAction, queueAction]
extensionContext?.notificationActions = newActions
}
completion(.doNotDismiss)
}</code></pre>

<p>By resetting the <code>extensionContext?.notificationActions</code> list to contain the updated actions, it allows us to change the actions every time the user selects one. The behavior is shown in the gif below.</p>

<figure>)</figcaption></figure>

<h3 id="summary">Summary</h3>

<p>There’s a lot to do before iOS 12 launches to make sure your notifications are ready. The steps vary in complexity and you don&rsquo;t have to implement them all. Make sure to first download XCode 10 beta so you can try out the features we&rsquo;ve gone over. If you want to play around with the demo app I&rsquo;ve referenced throughout the article, check it out on .</p>

<h4 id="for-your-notification-permissions-request-and-settings-you-ll-need-to">For Your Notification Permissions Request And Settings, You’ll Need To:</h4>

<ul>
<li>Determine whether or not you want to enable provisional authorization and add it to your authorization options.</li>
<li>If you have already have a customized notification settings view in your app, add <code>providesAppNotificationSettings</code> to your authorization options as well as implement the call back in your app delegate or whichever class conforms to <code>UNUserNotificationCenterDelegate</code>.</li>
</ul>

<h4 id="for-notification-grouping">For Notification Grouping:</h4>

<ul>
<li>Add a thread identifier to your remote and local notifications so your notifications are correctly grouped in the Notification Center.</li>
<li>When registering your notification categories, add the category summary parameter if you want your grouped notification to be more descriptive than “more notifications.”</li>
<li>If you want to customize the summary text even more, then add a summary identifier to match whichever formatting you added for the category summary.</li>
</ul>

<h4 id="for-customized-rich-notifications">For Customized Rich Notifications:</h4>

<ul>
<li>Add the Notification Content extension target to your app to create rich notifications.</li>
<li>Design and implement the view controller to contain whichever elements you want in your notification.</li>
<li>Consider which interactive elements would be useful to you, i.e. buttons, table view, switches, etc.</li>
<li>Update the <code>didReceive</code> method in the view controller to respond to selected actions and update the list of actions if necessary.</li>
</ul>

<h3 id="further-reading">Further Reading</h3>

<ul>
<li>“,” Apple’s list of various documentation regarding user notifications</li>
<li>“,” WWDC 2018 Apple</li>
<li>“,” Apple’s documentation on the Notification Content Extension</li>
</ul>

<div class="signature">
  <img src="https://www.smashingmagazine.com/images/logo/logo--red.png" alt="Smashing Editorial">
  <span>(ra, yk, il)</span>
</div>


              </article>
            </body>
          </html>
---------------
<h1 id="#title_10" >11、浪潮成立Inspur DevOps Lab：以应用开发和平台服务打造开发者生态</h1>
张蝉
[http://www.infoq.com/cn/news/2018/09/inspur-devops-lab?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global](http://www.infoq.com/cn/news/2018/09/inspur-devops-lab?utm_campaign=infoq_content&utm_source=infoq&utm_medium=feed&utm_term=global)
<img src="http://www.infoq.com/styles/i/logo_bigger.jpg"/><p>浪潮将通过Inspur DevOps Lab，基于云、数优势，聚焦应用开发和平台服务，提供从应用开发、测试、部署到运维的一站式闭环服务，吸引更多开发者加入，逐步形成“融合，开放，共享”的云生态圈。</p> <i>By 张蝉</i>
---------------