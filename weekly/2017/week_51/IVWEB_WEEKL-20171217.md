## 文章索引
1、 <a href="#1欢迎来到新时代html-52-已成为-w3c-新推荐标准" >欢迎来到新时代，HTML 5.2 已成为 W3C 新推荐标准</a><br/>
2、 <a href="#2angular-520-beta0-和-511-发布web-前端框架" >Angular 5.2.0-beta.0 和 5.1.1 发布，Web 前端框架</a><br/>
3、 <a href="#3linux-mint-183-sylvia-xfce-和-kde-桌面环境版发布" >Linux Mint 18.3 "Sylvia" Xfce 和 KDE 桌面环境版发布</a><br/>
4、 <a href="#4symfony-402-和-342-发布包含重要的-bug-修复" >Symfony 4.0.2 和 3.4.2 发布，包含重要的 Bug 修复</a><br/>
5、 <a href="#5pycharm-201731-发布bug-修复和功能方面的小改进" >PyCharm 2017.3.1 发布，Bug 修复和功能方面的小改进</a><br/>
6、 <a href="#6feilong-core-1106让-java-开发更简便的工具包" >feilong-core 1.10.6，让 Java 开发更简便的工具包</a><br/>
7、 <a href="#7vscrawler-021发布适合用作抓取的爬虫框架" >vscrawler 0.2.1发布，适合用作抓取的爬虫框架</a><br/>
8、 <a href="#8blade-205-发布高性能简洁优雅的-mvc-框架" >Blade 2.0.5 发布，高性能简洁优雅的 MVC 框架</a><br/>
9、 <a href="#9码云推荐-|-基于-range-和哈希取模的轻量级分库分表组件" >码云推荐 | 基于 Range 和哈希取模的轻量级分库分表组件</a><br/>
10、 <a href="#10每日一博-|-从源码看-spark-读取-hive-表数据小文件和分块" >每日一博 | 从源码看 Spark 读取 Hive 表数据小文件和分块</a><br/>
11、 <a href="#11apache-tomcat-8048-发布完全支持-java-9" >Apache Tomcat 8.0.48 发布，完全支持 Java 9</a><br/>
12、 <a href="#12kubeflow-谷歌开源的-kubernetes-机器学习工具集" >Kubeflow —— 谷歌开源的 Kubernetes 机器学习工具集</a><br/>
13、 <a href="#13oschina-周六乱弹-今晚宠幸哪一个" >OSChina 周六乱弹 —— 今晚宠幸哪一个？</a><br/>
14、 <a href="#14协作翻译-|-让-kotlin-代码库更有意思的魔法糖二" >协作翻译 | 让 Kotlin 代码库更有意思的“魔法糖”（二）</a><br/>
15、 <a href="#15加密库-libsodium-1016-发布包含性能改进" >加密库 libsodium 1.0.16 发布，包含性能改进</a><br/>
16、 <a href="#162018-最具就业前景的-7-大编程语言前三无悬念" >2018 最具就业前景的 7 大编程语言，前三无悬念？</a><br/>
17、 <a href="#17arangodb-330-正式发布分布式原生多模型数据库" >ArangoDB 3.3.0 正式发布，分布式原生多模型数据库</a><br/>
18、 <a href="#18开源电子书管理软件-calibre-314-发布常规更新" >开源电子书管理软件 Calibre 3.14 发布，常规更新</a><br/>
19、 <a href="#19腾讯谷歌-ai-开源框架-tensorflow-存在安全风险" >腾讯：谷歌 AI 开源框架 TensorFlow 存在安全风险</a><br/>
20、 <a href="#20behind-the-scenes:-improving-the-repository-infrastructure" >Behind the Scenes: Improving the Repository Infrastructure</a><br/><h1 id="#title_0" >1、欢迎来到新时代，HTML 5.2 已成为 W3C 新推荐标准</h1>

[https://www.oschina.net/news/91572/welcome-to-html-5-2](https://www.oschina.net/news/91572/welcome-to-html-5-2)
<p>W3C 万维网联盟近日宣布， 的首个工作草案也已发布，代表着相关工作已进入下一阶段。</p>
---------------
<h1 id="#title_1" >2、Angular 5.2.0-beta.0 和 5.1.1 发布，Web 前端框架</h1>

[https://www.oschina.net/news/91588/angular-5-2-0-beta0-and-5-1-1-released](https://www.oschina.net/news/91588/angular-5-2-0-beta0-and-5-1-1-released)
<p>Angular 5.2.0-beta.0 和 5.1.1 已发布，5.2.0-beta.0 主要是新增了一些特性，5.1.1 主要是修复了部分 bug，具体如下：</p><p>5.2.0-beta.0</p><p><strong>特性</strong></p><ul class=" list-paddingleft-2"><li><p><strong>animations:</strong>&nbsp;re-introduce support for transition matching functions (。<br/>
 源码下载：</p>
---------------
<h1 id="#title_2" >3、Linux Mint 18.3 "Sylvia" Xfce 和 KDE 桌面环境版发布</h1>

[https://www.oschina.net/news/91579/linux-mint-18-3-xfce-kde-released](https://www.oschina.net/news/91579/linux-mint-18-3-xfce-kde-released)
<p>上个月，Linux Mint ).</p></li></ul>
---------------
<h1 id="#title_3" >4、Symfony 4.0.2 和 3.4.2 发布，包含重要的 Bug 修复</h1>

[https://www.oschina.net/news/91586/symfony-4-0-2-and-3-4-2-released](https://www.oschina.net/news/91586/symfony-4-0-2-and-3-4-2-released)
<p>Symfony 4.0.2 和 3.4.2 已发布，两个版本都包含了对重要的 Bug 的修复。</p><p>点此查看 </p>
---------------
<h1 id="#title_4" >5、PyCharm 2017.3.1 发布，Bug 修复和功能方面的小改进</h1>

[https://www.oschina.net/news/91585/pycharm-2017-3-1-released](https://www.oschina.net/news/91585/pycharm-2017-3-1-released)
<p>PyCharm 2017.3.1 已发布，该版本提供了一些修复和功能方面小的改进。包含以下的更新：</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p>运行 Python 模块&nbsp;(-m)的几个问题已解决：运行远程模块，运行后显示命令行</p></li><li><p>解决了通过 SSH 运行代码的进一步问题：现在可以从 macOS 连接到 IPv6 主机，不会误认为&nbsp;<code>ProxyCommand: none</code>，并正确解析&nbsp;<code>HostKeyAlgorithms</code>&nbsp;选项（仅在 PyCharm 专业版中支持通过 SSH 连接到 Python 解释器）</p></li><li><p>SQLAlchemy 的代码分析功能得到了改进，“不正确的调用参数”问题已得到解决</p></li></ul><p>更多更新内容请参阅</p>
---------------
<h1 id="#title_5" >6、feilong-core 1.10.6，让 Java 开发更简便的工具包</h1>

[https://www.oschina.net/news/91584/feilong-core-1-10-6](https://www.oschina.net/news/91584/feilong-core-1-10-6)
<p>feilong-core 1.10.6 发布了。feilong-core 是一个让 Java 开发更简便的工具包,&nbsp;可以让你从大量重复的底层代码中脱身,提高工作效率; 让你的代码更简炼，易写、易读、易于维护;</p><p>本次升级共有&nbsp;20&nbsp;处变更, 具体参见&nbsp;&nbsp;添加&nbsp;ParamUtil.toNaturalOrderingKeyJoinValue(Map&lt;String, String&gt;)&nbsp;新建 将key和map直接拼接的方法</p></li></ul><p>将&nbsp;singleValueMap&nbsp;转成自然排序, 然后将key和value直接拼接成字符串(不使用 = 和&amp; 分隔).</p><p>示例:</p><pre>&nbsp;Map&lt;String,&nbsp;String&gt;&nbsp;map&nbsp;=&nbsp;new&nbsp;HashMap&lt;&gt;();
&nbsp;map.put(&quot;service&quot;,&nbsp;&quot;create_salesorder&quot;);
&nbsp;map.put(&quot;_input_charset&quot;,&nbsp;&quot;gbk&quot;);
&nbsp;map.put(&quot;totalActual&quot;,&nbsp;&quot;210.00&quot;);
&nbsp;map.put(&quot;address&quot;,&nbsp;&quot;江苏南通市通州区888组888号&quot;);&nbsp;LOGGER.debug(ParamUtil.toNaturalOrderingKeyJoinValue(map));</pre><p>返回:</p><pre>&nbsp;_input_charsetgbkaddress江苏南通市通州区888组888号servicecreate_salesordertotalActual210.00</pre><ul class=" list-paddingleft-2"><li><p>&nbsp;SortUtil&nbsp;新增&nbsp;Map&lt;K, V&gt; sortMapByKeyFixOrder(Map&lt;K, V&gt; map,K...keys)&nbsp;map 按照指定的固定key的顺序排序</p></li></ul><p>按照key 指定名字顺序排序.</p><p>注意:</p><p>原 map 的顺序不变</p><p>示例:</p><pre>&nbsp;Map&lt;String,&nbsp;Integer&gt;&nbsp;map&nbsp;=&nbsp;new&nbsp;HashMap&lt;&gt;();

&nbsp;map.put(&quot;DE&quot;,&nbsp;99);
&nbsp;map.put(&quot;L&quot;,&nbsp;3428);
&nbsp;map.put(&quot;O&quot;,&nbsp;13);
&nbsp;map.put(&quot;UN&quot;,&nbsp;17);
&nbsp;map.put(&quot;S&quot;,&nbsp;6);&nbsp;//L-上市，S-暂停，DE-终止上市，UN-未上市&nbsp;Map&lt;String,&nbsp;Integer&gt;&nbsp;sortByKeyAsc&nbsp;=&nbsp;sortMapByKeyFixOrder(map,&nbsp;&quot;L&quot;,&nbsp;&quot;UN&quot;,&nbsp;&quot;DE&quot;,&nbsp;&quot;S&quot;,&nbsp;&quot;O&quot;);&nbsp;LOGGER.debug(JsonUtil.format(sortByKeyAsc));</pre><p>返回:</p><pre>{&nbsp;&quot;L&quot;:&nbsp;3428,&nbsp;&quot;UN&quot;:&nbsp;17,&nbsp;&quot;S&quot;:&nbsp;6,&nbsp;&quot;DE&quot;:&nbsp;99,&nbsp;&quot;O&quot;:&nbsp;13&nbsp;}</pre><ul class=" list-paddingleft-2"><li><p>&nbsp;AggregateUtil&nbsp;新增可以按照 多个属性名字来 groupCount的方法</p></li></ul><p>com.feilong.core.util.AggregateUtil.groupCount(Iterable, String[])</p><p>com.feilong.core.util.AggregateUtil.groupCount(Iterable, String[], Predicate)</p><p>循环&nbsp;beanIterable,只选择符合&nbsp;includePredicate&nbsp;的对象,统计 propertyName的值出现的次数.</p><p>说明:</p><p>返回的LinkedHashMap,key是propertyName名字,子map的key是propertyName对应的值,value是该值出现的次数;<br/>顺序是 beanIterable propertyName的值的顺序</p><p>示例:</p><h4>场景: 统计user list,属性名字是name 的值的数量 以及age值的数量</h4><pre>List&lt;User&gt;&nbsp;list&nbsp;=&nbsp;toList(//&nbsp;new&nbsp;User(&quot;张飞&quot;,&nbsp;20),&nbsp;new&nbsp;User(&quot;关羽&quot;,&nbsp;30),&nbsp;new&nbsp;User(&quot;赵云&quot;,&nbsp;50),&nbsp;new&nbsp;User(&quot;刘备&quot;,&nbsp;40),&nbsp;new&nbsp;User(&quot;刘备&quot;,&nbsp;30),&nbsp;new&nbsp;User(&quot;赵云&quot;,&nbsp;50));&nbsp;Map&lt;String,&nbsp;Map&lt;Object,&nbsp;Integer&gt;&gt;&nbsp;map&nbsp;=&nbsp;AggregateUtil.groupCount(list,&nbsp;toArray(&quot;name&quot;,&nbsp;&quot;age&quot;));&nbsp;LOGGER.debug(JsonUtil.format(map));</pre><p>返回:</p><pre>{&nbsp;&quot;age&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&quot;20&quot;:&nbsp;1,&nbsp;&quot;30&quot;:&nbsp;2,&nbsp;&quot;50&quot;:&nbsp;2,&nbsp;&quot;40&quot;:&nbsp;1&nbsp;},&nbsp;&quot;name&quot;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&quot;张飞&quot;:&nbsp;1,&nbsp;&quot;关羽&quot;:&nbsp;1,&nbsp;&quot;赵云&quot;:&nbsp;2,&nbsp;&quot;刘备&quot;:&nbsp;2&nbsp;}
}</pre><ul class=" list-paddingleft-2"><li><p>&nbsp;BeanPredicateUtil&nbsp;新增&nbsp;Predicate&lt;T&gt; equalPredicate(T bean,String...propertyNames)</p></li></ul><p>构造属性与一个指定对象 bean 的一组属性的值 propertyNames 都相等的判断器.</p><p>说明:</p><p>常用于解析集合,如 select,find, selectRejected, group, groupCount, sum 等方法.</p><p>示例:</p><h4>场景: 在list中查找 名字是 关羽,并且 年龄是30 的user</h4><pre>&nbsp;User&nbsp;guanyu30&nbsp;=&nbsp;new&nbsp;User(&quot;关羽&quot;,&nbsp;30);&nbsp;List&lt;User&gt;&nbsp;list&nbsp;=&nbsp;toList(//&nbsp;new&nbsp;User(&quot;张飞&quot;,&nbsp;23),&nbsp;new&nbsp;User(&quot;关羽&quot;,&nbsp;24),&nbsp;new&nbsp;User(&quot;刘备&quot;,&nbsp;25),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guanyu30);&nbsp;Predicate&lt;User&gt;&nbsp;predicate&nbsp;=&nbsp;PredicateUtils&nbsp;.andPredicate(BeanPredicateUtil.equalPredicate(&quot;name&quot;,&nbsp;&quot;关羽&quot;),&nbsp;BeanPredicateUtil.equalPredicate(&quot;age&quot;,&nbsp;30));

&nbsp;assertEquals(guanyu30,&nbsp;CollectionsUtil.find(list,&nbsp;predicate));</pre><p>此时你可以优化成:</p><pre>&nbsp;User&nbsp;guanyu30&nbsp;=&nbsp;new&nbsp;User(&quot;关羽&quot;,&nbsp;30);&nbsp;List&lt;User&gt;&nbsp;list&nbsp;=&nbsp;toList(//&nbsp;new&nbsp;User(&quot;张飞&quot;,&nbsp;23),&nbsp;new&nbsp;User(&quot;关羽&quot;,&nbsp;24),&nbsp;new&nbsp;User(&quot;刘备&quot;,&nbsp;25),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guanyu30);

&nbsp;assertEquals(guanyu30,&nbsp;find(list,&nbsp;BeanPredicateUtil.equalPredicate(guanyu30,&nbsp;&quot;name&quot;,&nbsp;&quot;age&quot;)));</pre><ul class=" list-paddingleft-2"><li><p>&nbsp;ThreadUtil&nbsp;添加 javadoc 关于 callable Javadoc</p></li></ul><h3>[log]</h3><ul class=" list-paddingleft-2"><li><p>none</p></li></ul>
---------------
<h1 id="#title_6" >7、vscrawler 0.2.1发布，适合用作抓取的爬虫框架</h1>

[https://www.oschina.net/news/91583/vscrawler-0-2-1](https://www.oschina.net/news/91583/vscrawler-0-2-1)
<p>VSCrawler是一个适合用作抓取的爬虫框架，在更多场景倾向于功能扩展性而牺牲使用简便性。这让VSCrawler非常强大，让他可以灵活的应对目标网站的反爬虫策略。</p><p>vscrawler有挺多特点</p><p>1. 多用户登录，天生支持多用户登录，各个用户资源隔离维护。</p><p>2.数据完整性保证，vs保证即使爬虫宕机也会尽力序列化爬虫任务。</p><p>3.任务调度，vs目前不支持其他爬虫框架schedular角色的定制，不过vs本身的任务调度很完善，支持自定义消重规则、断点续爬、重试规则定制、重复抓取（在消重之上封装了可重入的特性）</p><p>4.抽取器，vs结合其他爬虫框架的实现，封装了整套抽取器体系。包括css query &amp;&amp; xpath（SipSoup，自JsoupXpath和Xsoup发展而来）、链式抽取（集合正则、xpath、css query、字符串处理函数、jsonpath）、字符串函数（基于表达式描述字符串逻辑，配合字符串函数表达式可以实现无编码支持字符串局部清洗处理）、表格处理（在css 和xpath特征都不明显的html文档上面使用很方便）</p><p>5.热发控制，vs有一个热发配置文件，只有配置文件配置项修改了，vs内部组件便可以感知到配置变更，同时执行对象更新操作。比如可以动态修改执行工作线程数量</p><p>6.代理规则，vs设计之前我便有一套完善的代理ip池系统（dungproxy），ip池本身就有基于顺序惩罚模型的权值轮询队列，基于ip质量自动探测的方式调度ip使用顺序，实现了在免费的劣质ip源上架构稳定代理服务的系统。目前vs默认集成了dungproxy，当然ip系统也是完全可以替换的</p><p>7.mq模型的事件循环系统，vs内置一个EventLoop，用来实现各个组件低耦合的通信。对于vs的深度定制几乎不需要依靠各种生命周期回调，只需要订阅感兴趣的消息，然后就可以自动接收各种消息，同时也可以发送各种消息。</p><p>本次更新，主要完善了vscrawler对注解模式爬虫的支持，自此vscrawler也可以使用java注解描述爬虫规则了。<br/></p><p>vsvcrawler在实现注解爬虫的时候参考了webmagic和gecco两个爬虫框架，同时更好的集成了链式抽取，子model递归抽取，弱类型推测，以及提供了注解爬虫生命周期回调（用来弥补注解爬虫带来的扩展性制约问题），基于package扫描的taskbean注册等功能。</p><p>使用demo：</p><pre>public&nbsp;class&nbsp;U5ProxyIpCrawler&nbsp;extends&nbsp;AbstractAutoProcessModel&nbsp;{

&nbsp;&nbsp;&nbsp;&nbsp;@Xpath(&quot;/span[1]/li/text()&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;@Getter
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;ip;

&nbsp;&nbsp;&nbsp;&nbsp;@Xpath(&quot;//css(&#39;.port&#39;)::self()/text()&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;@Getter
&nbsp;&nbsp;&nbsp;&nbsp;//type可以是一般的常用类型,框架会自动做类型转换,转换规则满足一般的弱语言规则,当不能强转时将会报错,如果你抓取的网站格式可能超过你预期范围,建议使用string来接收
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Integer&nbsp;port;

&nbsp;&nbsp;&nbsp;&nbsp;@Xpath(&quot;/span[3]/li/allText()&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;//关于allText和text的区别,allText将会抽取子节点文本(对应Jsoup的text),text只会抽取当前节点文本(对应Jsoup的ownText),xpath语法细节请了解SipSoup这个项目
&nbsp;&nbsp;&nbsp;&nbsp;@Getter
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;anonymous;

&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;main(String[]&nbsp;args)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VSCrawlerBuilder
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.create()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setProcessor(AnnotationProcessorBuilder
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.create()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.registryBean(U5ProxyIpCrawler.class)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.build())
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setCrawlerName(&quot;u5ProxyCrawler&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.build()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.clearTask()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.pushSeed(&quot;http://www.data5u.com/free/index.shtml&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.run();
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>或者使用对子model递归解析</p><pre>@AutoProcessor(seedPattern&nbsp;=&nbsp;&quot;https://www\\.meitulu\\.com.*&quot;)
public&nbsp;class&nbsp;Star&nbsp;extends&nbsp;AbstractAutoProcessModel&nbsp;{

&nbsp;&nbsp;&nbsp;&nbsp;@Getter
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;starName;

&nbsp;&nbsp;&nbsp;&nbsp;@Getter
&nbsp;&nbsp;&nbsp;&nbsp;//@Xpath(&quot;/css(&#39;.listtags_r&#39;)::self()/allText()&quot;)&nbsp;//如果只抽文本,则使用allText
&nbsp;&nbsp;&nbsp;&nbsp;@Xpath(&quot;/css(&#39;.listtags_r&#39;)::self()/html()&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;desciption;

&nbsp;&nbsp;&nbsp;&nbsp;@Xpath(&quot;/css(&#39;.listtags_l&#39;)::img/absUrl(&#39;src&#39;)&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;//absUrl可以处理相对路径和绝对路径问题,如果url是相对路径,absUrl会自动转化为绝对路径
&nbsp;&nbsp;&nbsp;&nbsp;@Getter
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;headPicture;

&nbsp;&nbsp;&nbsp;&nbsp;@Xpath(value&nbsp;=&nbsp;&quot;//div[@class=&#39;boxs&#39;]/ul[@class=&#39;img&#39;]/li&quot;,&nbsp;elementType&nbsp;=&nbsp;Album.class)
&nbsp;&nbsp;&nbsp;&nbsp;//由于泛型擦除可能,框架不能自动判断list内部的Album类型,所以需要elementType来制定,否则这里抽取得到的原始数据类型是element(Jsoup对象)
&nbsp;&nbsp;&nbsp;&nbsp;@Getter
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;List&lt;Album&gt;&nbsp;albumList;
&nbsp;&nbsp;&nbsp;&nbsp;@NewSeed
&nbsp;&nbsp;&nbsp;&nbsp;@Xpath(&quot;//a/absUrl(&#39;href&#39;)&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;//@JSONField(serialize&nbsp;=&nbsp;false)
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ListseedUrl;
&nbsp;&nbsp;&nbsp;&nbsp;@Override
&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;void&nbsp;beforeAutoFetch()&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.beforeAutoFetch();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Matcher&nbsp;matcher&nbsp;=&nbsp;Pattern.compile(&quot;https://www\\.meitulu\\.com/t/([^/]+)&quot;).matcher(baseUrl);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(matcher.find())&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starName&nbsp;=&nbsp;matcher.group(1);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>注解爬虫详细文档稍后将会维护在项目主页：</p><p>项目demo都可以在gitee上找到：</p>
---------------
<h1 id="#title_7" >8、Blade 2.0.5 发布，高性能简洁优雅的 MVC 框架</h1>

[https://www.oschina.net/news/91582/blade-2-0-5](https://www.oschina.net/news/91582/blade-2-0-5)
<p><img data-cke-saved-src="https://static.oschina.net/uploads/space/2017/1216/170217_gokP_1767531.png" src="https://static.oschina.net/uploads/space/2017/1216/170217_gokP_1767531.png" width="450" height="197" align="left" alt="Blade" border="0" hspace="0" vspace="0" title="" style="width: 450px; height: 197px; float: left;"/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><ol class=" list-paddingleft-2"><li><p>支持 WebSocket</p></li><li><p>支持 SSL 配置</p></li><li><p>支持自定义启动 BannerText</p></li><li><p>支持自定义启动线程名称</p></li><li><p>支持自定义业务线程前缀</p></li><li><p>获取 Environment 参数允许设置默认值</p></li><li><p>升级 Netty 版本到 4.1.18.Final</p></li><li><p>修复获取客户端 IP 地址</p></li><li><p>修复 robots.txt 请求导致的异常</p></li><li><p>修复 Nginx 下获取 Cookie 小写问题</p></li><li><p>添加 CollectionKit 工具类</p></li><li><p>添加 StringKit.isAnyBlank() 方法</p></li></ol><p>Github 地址：</p>
---------------
<h1 id="#title_8" >9、码云推荐 | 基于 Range 和哈希取模的轻量级分库分表组件</h1>

[https://gitee.com/qiangzigege/MyShardingSql](https://gitee.com/qiangzigege/MyShardingSql)
<p>MyShardingSql ,我自己的分库分表组件, 基于 Range 和哈希取模实现的轻量级分库分表组件，支持事务,分库分表,读写分离，基于 MyBatis+插件+Druid+JSqlParser 实现。</p>
---------------
<h1 id="#title_9" >10、每日一博 | 从源码看 Spark 读取 Hive 表数据小文件和分块</h1>

[https://my.oschina.net/kavn/blog/1590032](https://my.oschina.net/kavn/blog/1590032)
<p>使用 Spark 进行数据分析和计算早已成趋势，你是否关注过读取一张 Hive 表时 Task 数为什么是那么多呢？它跟什么有关系呢？ 最近刚好碰到这个问题，而之前对此有些模糊，所以做了些整理，希望大家拍砖探讨。</p>
---------------
<h1 id="#title_10" >11、Apache Tomcat 8.0.48 发布，完全支持 Java 9</h1>

[https://www.oschina.net/news/91589/apache-tomcat-8-0-48-released](https://www.oschina.net/news/91589/apache-tomcat-8-0-48-released)
<p>Apache Tomcat 8.0.48 已发布，该版本最值得关注的更新莫过于对 Java 9 的完全支持。</p><p>Apache Tomcat 8.0.48 包含针对 8.0.47 中标识的问题的修复以及其他功能增强和改变。自 8.0.47 以来的显着变化包括：</p><ul class=" list-paddingleft-2"><li><p>完全支持 Java 9</p></li><li><p>将 Tomcat 原生库的打包版本更新为 1.2.16，使用 APR 1.6.3 和 OpenSSL 1.0.2m 构建最新的 Windows 二进制文件</p></li></ul><p><strong>请注意，Tomcat 8.x 用户应该考虑选择使用 8.5.x 系列版本了，因为 Apache Tomcat 团队</strong></p>
---------------
<h1 id="#title_11" >12、Kubeflow —— 谷歌开源的 Kubernetes 机器学习工具集</h1>

[https://www.oschina.net/p/kubeflow](https://www.oschina.net/p/kubeflow)
<p>Kubeflow 是谷歌发布的一个机器学习工具库，Kubeflow 项目旨在使 Kubernetes 上的机器学习变的轻松、便捷、可扩展，其目标不是重建其他服务，而是提供一种简便的方式找到最好的 OSS 解决方案。</p>
---------------
<h1 id="#title_12" >13、OSChina 周六乱弹 —— 今晚宠幸哪一个？</h1>

[https://my.oschina.net/xxiaobian/blog/1590643](https://my.oschina.net/xxiaobian/blog/1590643)
<p>一个朋友93年的就说要去植发，我心里感叹，这才多大呀，就挣够植发的钱了。</p>
---------------
<h1 id="#title_13" >14、协作翻译 | 让 Kotlin 代码库更有意思的“魔法糖”（二）</h1>

[https://www.oschina.net/translate/6-magic-sugars-make-your-kotlin-codebase-happier-part-2](https://www.oschina.net/translate/6-magic-sugars-make-your-kotlin-codebase-happier-part-2)
<p>在本篇中，我会为你展示我经常使用的带有表现层的组件。同样我会给你展示如何使用 inline reified 函数。希望你能像我一样喜欢我介绍的这些语法糖。</p>
---------------
<h1 id="#title_14" >15、加密库 libsodium 1.0.16 发布，包含性能改进</h1>

[https://www.oschina.net/news/91575/libsodium-1-0-16-released](https://www.oschina.net/news/91575/libsodium-1-0-16-released)
<p>libsodium 1.0.16 已发布，更新如下：</p><ul class=" list-paddingleft-2"><li><p>Signatures computations and verifications are now way faster on 64-bit platforms with compilers supporting 128-bit arithmetic (gcc, clang, icc). This includes the WebAssembly target.</p></li><li><p>New low-level APIs for computations over edwards25519:&nbsp;<code>crypto_scalarmult_ed25519()</code>,<code>crypto_scalarmult_ed25519_base()</code>,&nbsp;<code>crypto_core_ed25519_is_valid_point()</code>,&nbsp;<code>crypto_core_ed25519_add()</code>,<br/><code>crypto_core_ed25519_sub()</code>&nbsp;and&nbsp;<code>crypto_core_ed25519_from_uniform()</code>&nbsp;(elligator representative to point).</p></li><li><p><code>crypto_sign_open()</code>,&nbsp;<code>crypto_sign_verify_detached() and</code>crypto_sign_edwards25519sha512batch_open` now reject public keys in non-canonical form in addition to low-order points.</p></li><li><p>The library can be built with&nbsp;<code>ED25519_NONDETERMINISTIC</code>&nbsp;defined in order to use synthetic nonces for EdDSA. This is disabled by default.</p></li><li><p>Webassembly:&nbsp;<code>crypto_pwhash_*()</code>&nbsp;functions are now included in non-sumo builds.</p></li><li><p><code>sodium_stackzero()</code>&nbsp;was added to wipe content off the stack.</p></li><li><p>Android: support new SDKs where unified headers have become the default.</p></li><li><p>The Salsa20-based PRNG example is now thread-safe on platforms with support for thread-local storage, optionally mixes bits from RDRAND.</p></li><li><p>CMAKE: static library detection on Unix systems has been improved (thanks to&nbsp;&nbsp;开发，提供一个兼容 API 的加密库。</p>
---------------
<h1 id="#title_15" >16、2018 最具就业前景的 7 大编程语言，前三无悬念？</h1>

[https://www.oschina.net/news/91574/7-most-in-demand-programming-languages-of-2018](https://www.oschina.net/news/91574/7-most-in-demand-programming-languages-of-2018)
<p>软件开发是一个动态的领域。新的编程语言、框架和技术陆续出现，流行，然后消失。开发者需要不断学习新技能，掌握企业发展所需要的新技术。</p><p><img height="600" data-cke-saved-src="https://static.oschina.net/uploads/space/2017/1215/113336_LI3s_2896879.png" src="https://static.oschina.net/uploads/space/2017/1215/113336_LI3s_2896879.png" width="1200"/></p><p>2018年即将到来，Coding Dojo（编码道场）近期发布了 。</p>
---------------
<h1 id="#title_16" >17、ArangoDB 3.3.0 正式发布，分布式原生多模型数据库</h1>

[https://www.oschina.net/news/91573/arangodb-3-3-0-released](https://www.oschina.net/news/91573/arangodb-3-3-0-released)
<p>ArangoDB 3.3.0 已正式发布，ArangoDB 是一个开源的分布式原生多模型数据库 (Apache 2 license)。</p><h3>理念&nbsp;&nbsp;</h3><p>利用一个引擎，一个 query 语法，一项数据库技术，以及多个数据模型，来最大力度满足项目的灵活性，简化技术堆栈，简化数据库运维，降低运营成本。</p><p>ArangoDB原生多模型数据库，指的是兼有图 (graph)、文档 (document)和键/值对 (key/value) 三种数据模型存储软件。其快捷灵活之处在于，它有适用于全部三种数据模型的统一内核和统一数据库查询语言——</p></li></ul>
---------------
<h1 id="#title_17" >18、开源电子书管理软件 Calibre 3.14 发布，常规更新</h1>

[https://www.oschina.net/news/91587/calibre-3-14-released](https://www.oschina.net/news/91587/calibre-3-14-released)
<p>Calibre 3.14 已发布，Calibre 是一款功能强大的电子书管理软件，支持 Amazon、Apple、Bookeen、Ectaco、Endless Ideas、Google/HTC、Hanlin Song 设备及格式。</p><p>该版本新增了一些新功能，以及修复了部分 bug，具体如下：</p><p><strong>新特性</strong></p><ul class=" list-paddingleft-2"><li><p>User manual: A new quick reference primer for regular expression syntax&nbsp;。</p>
---------------
<h1 id="#title_18" >19、腾讯：谷歌 AI 开源框架 TensorFlow 存在安全风险</h1>

[https://www.oschina.net/news/91571/tencent-report-tensorflow-security-risk](https://www.oschina.net/news/91571/tencent-report-tensorflow-security-risk)
<p>消息，腾讯安全平台部预研团队日前发现谷歌人工智能学习系统 TensorFlow 存在自身安全风险，可被黑客利用带来安全威胁，其已向谷歌报告这一风险并获得致谢。</p><p>腾讯安全平台部预研团队发现，攻击者可以生成 Tensorflow 的恶意模型文件，对 AI 研究者进行攻击，对受害者自身的 AI 应用进行窃取或篡改、破坏。该风险危害面非常大，一方面攻击成本低，普通攻击者即可实施攻击；另一方面迷惑性强，大部分 AI 研究者可能毫无防备；同时因为利用了 TensorFlow 自身的机制，其在 PC 端和移动端的最新版本均会受到影响。AI 模型被窃取，损失的是开发者的心血；而一旦被篡改，造成 AI 失控，后果更难以想象。</p><p>谷歌官方负责人称，考虑到 TensorFlow 在 AI 的广泛使用，TensorFlow 官网将会像大多数重要软件一样在网站创建安全公告页面，及时披露和修复安全漏洞。</p><p><img alt="" height="338" data-cke-saved-src="https://static.oschina.net/uploads/space/2017/1216/073654_DiaQ_2896879.jpg" src="https://static.oschina.net/uploads/space/2017/1216/073654_DiaQ_2896879.jpg" width="600"/></p>
---------------
<h1 id="#title_19" >20、Behind the Scenes: Improving the Repository Infrastructure</h1>

[https://reactjs.org/blog/2017/12/15/improving-the-repository-infrastructure.html](https://reactjs.org/blog/2017/12/15/improving-the-repository-infrastructure.html)
<p>As we worked on  into our workflow. People often ask us questions about how we use those tools. In this post, we would like to share some of the changes that we’ve made to our build and test infrastructure in 2017, and what motivated them.</p>
<p>While these changes helped us make React better, they don’t affect most React users directly. However, we hope that blogging about them might help other library authors solve similar problems. Our contributors might also find these notes helpful!</p>
<h2 id="formatting-code-with-prettier">Formatting Code with Prettier</h2>
<p>React was one of the first large repositories to . Our current Prettier setup consists of:</p>
<ul>
<li>A local .</li>
<li>A script that . It won’t attempt to overwrite the files, but instead will fail the build if any file differs from the Prettier output for that file. This ensures that we can’t merge a pull request unless it has been fully formatted.</li>
</ul>
<p>Some team members have also set up the . Our experience with Prettier has been fantastic, and we recommend it to any team that writes JavaScript.</p>
<h2 id="restructuring-the-monorepo">Restructuring the Monorepo</h2>
<p>Ever since React was split into packages, it has been a : a set of packages under the umbrella of a single repository. This made it easier to coordinate changes and share the tooling, but our folder structure was deeply nested and difficult to understand. It was not clear which files belonged to which package. After releasing React 16, we’ve decided to completely reorganize the repository structure. Here is how we did it.</p>
<h3 id="migrating-to-yarn-workspaces">Migrating to Yarn Workspaces</h3>
<p>The Yarn package manager  a few months ago. This feature lets you tell Yarn where your monorepo’s packages are located in the source tree. Every time you run <code>yarn</code>, in addition to installing your dependencies it also sets up the symlinks that point from your project’s <code>node_modules</code> to the source folders of your packages.</p>
<p>Thanks to Workspaces, absolute imports between our own packages (such as importing <code>react</code> from <code>react-dom</code>) “just work” with any tools that support the Node resolution mechanism. The only problem we encountered was Jest not running the transforms inside the linked packages, but we , and it was merged into Jest.</p>
<p>To enable Yarn Workspaces, we added <code>"workspaces": ["packages/*"]</code> to our , each with its own <code>package.json</code> file.</p>
<p>Each package is structured in a similar way. For every public API entry point such as <code>react-dom</code> or <code>react-dom/server</code>, there is a  folder that point to the build artifacts.</p>
<p>Not all packages have to be published on npm. For example, we keep some utilities that are tiny enough and can be safely duplicated in a  so it happily bundles the <code>shared</code> code into <code>react</code> and <code>react-dom</code> without leaving any references to <code>shared/</code> in the build artifacts. So you can use Yarn Workspaces even if you don’t plan to publish actual npm packages!</p>
<h3 id="removing-the-custom-module-system">Removing the Custom Module System</h3>
<p>In the past, we used a non-standard module system called “Haste” that lets you import any file from any other file by its unique <code>@providesModule</code> directive no matter where it is in the tree. It neatly avoids the problem of deep relative imports with paths like <code>../../../../</code> and is great for the product code. However, this makes it hard to understand the dependencies between packages. We also had to resort to hacks to make it work with different tools.</p>
<p>We decided to  so that it goes at most one level deep inside each package:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-none"><code>|-react
|  |-npm
|  |-src
|-react-dom
|  |-npm
|  |-src
|  |  |-client
|  |  |-events
|  |  |-server
|  |  |-shared</code></pre>
      </div>
<p>This way, the relative paths can only contain one <code>./</code> or <code>../</code> followed by the filename. If one package needs to import something from another package, it can do so with an absolute import from a top-level entry point.</p>
<p>In practice, we still have  that violate this principle, but they’re explicit, and we plan to gradually get rid of them.</p>
<h2 id="compiling-flat-bundles">Compiling Flat Bundles</h2>
<p>Historically, React was distributed in two different formats: as a single-file build that you can add as a <code>&#x3C;script></code> tag in the browser, and as a collection of CommonJS modules that you can bundle with a tool like webpack or Browserify. </p>
<p>Before React 16, each React source file had a corresponding CommonJS module that was published as part of the npm packages. Importing <code>react</code> or <code>react-dom</code> led bundlers to the package .</p>
<p>However, this approach had multiple disadvantages:</p>
<ul>
<li><strong>It was inconsistent.</strong> Different tools produce bundles of different sizes for identical code importing React, with the difference going as far as 30 kB (before gzip).</li>
<li><strong>It was inefficient for bundler users.</strong> The code produced by most bundlers today contains a lot of “glue code” at the module boundaries. It keeps the modules isolated from each other, but increases the parse time, the bundle size, and the build time.</li>
<li><strong>It was inefficient for Node users.</strong> When running in Node, performing <code>process.env.NODE_ENV</code> checks before development-only code incurs the overhead of actually looking up environment variables. This slowed down React server rendering. We couldn’t cache it in a variable either because it prevented dead code elimination with Uglify.</li>
<li><strong>It broke encapsulation.</strong> React internals were exposed both in the open source (as <code>react-dom/lib/*</code> imports) and internally at Facebook. It was convenient at first as a way to share utilities between projects, but with time it became a maintenance burden because renaming or changing argument types of internal functions would break unrelated projects.</li>
<li><strong>It prevented experimentation.</strong> There was no way for the React team to experiment with any advanced compilation techniques. For example, in theory, we might want to apply  to some of our code, but they are designed to work on complete bundles rather than small individual modules that we used to ship to npm.</li>
</ul>
<p>Due to these and other issues, we’ve changed the strategy in React 16. We still ship CommonJS modules for Node.js and bundlers, but instead of publishing many individual files in the npm package, we publish just two CommonJS bundles per entry point.</p>
<p>For example, when you import <code>react</code> with React 16, the bundler  that just re-exports one of the two files:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./cjs/react.production.min.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./cjs/react.development.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>In every package provided by React, the  (short for “CommonJS”) contains a development and a production pre-built bundle for each entry point. </p>
<p>For example,  was minified and optimized before it was published to npm.</p>
<p>Note how this is essentially the same strategy that we’ve been using for the single-file browser builds (which now reside in the ). Now we just apply the same strategy to the CommonJS builds as well.</p>
<h3 id="migrating-to-rollup">Migrating to Rollup</h3>
<p>Just compiling CommonJS modules into single-file bundles doesn’t solve all of the above problems. The really significant wins came from .</p>
<p>, and it is a perfect fit for React’s use case. It solves one problem well: how to combine multiple modules into a flat file with minimal junk code in between. To achieve this, instead of turning modules into functions like many other bundlers, it puts all the code in the same scope, and renames variables so that they don’t conflict. This produces code that is easier for the JavaScript engine to parse, for a human to read, and for a minifier to optimize.</p>
<p>Rollup currently doesn’t support some features that are important to application builders, such as code splitting. However, it does not aim to replace tools like webpack that do a great job at this. Rollup is a perfect fit for <em>libraries</em> like React that can be pre-built and then integrated into apps.</p>
<p>You can find our Rollup build configuration .</p>
<h3 id="migrating-to-google-closure-compiler">Migrating to Google Closure Compiler</h3>
<p>After migrating to flat bundles, we  in its “simple” mode. In our experience, even with the advanced optimizations disabled, it still provided a significant advantage over Uglify, as it was able to better eliminate dead code and automatically inline small functions when appropriate.</p>
<p>At first, we could only use Google Closure Compiler for the React bundles we shipped in the open source. At Facebook, we still needed the checked-in bundles to be unminified so we could symbolicate React production crashes with our error reporting tools. We ended up contributing . Interestingly, running Prettier on production bundles while debugging the build process is a great way to find unnecessary code in the bundles!</p>
<p>Currently, all production React bundles , and we may look into enabling advanced optimizations in the future.</p>
<h3 id="protecting-against-weak-dead-code-elimination">Protecting Against Weak Dead Code Elimination</h3>
<p>While we use an efficient  solution in React itself, we can’t make a lot of assumptions about the tools used by the React consumers.</p>
<p>Typically, when you , you need to tell it to substitute <code>process.env.NODE_ENV</code> with the <code>"production"</code> string literal. This process is sometimes called “envification”. Consider this code:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">!==</span> <span class="token string">"production"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// development-only code</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>After envification, this condition will always be <code>false</code>, and can be completely eliminated by most minifers:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"production"</span> <span class="token operator">!==</span> <span class="token string">"production"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// development-only code</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>However, if the bundler is miconfigured, you can accidentally ship development code into production. We can’t completely prevent this, but we took a few steps to mitigate the common cases when it happens.</p>
<h4 id="protecting-against-late-envification">Protecting Against Late Envification</h4>
<p>As mentioned above, our entry points now look like this:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./cjs/react.production.min.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./cjs/react.development.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>However, some bundlers process <code>require</code>s before envification. In this case, even if the <code>else</code> block never executes, the <code>cjs/react.development.js</code> file still gets bundled.</p>
<p>To prevent this, we also  of the development bundle into another <code>process.env.NODE_ENV</code> check inside the <code>cjs/react.development.js</code> bundle itself:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">!==</span> <span class="token string">"production"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// bundle code</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>This way, even if the application bundle includes both the development and the production versions of the file, the development version will be empty after envification.</p>
<p>The additional  wrapper is necessary because some declarations (e.g. functions) can’t be placed inside an <code>if</code> statement in JavaScript.</p>
<h4 id="detecting-misconfigured-dead-code-elimination">Detecting Misconfigured Dead Code Elimination</h4>
<p>Even though , many popular bundlers don’t yet force the users to specify the development or production mode. In this case <code>process.env.NODE_ENV</code> is typically provided by a runtime polyfill, but the dead code elimination doesn’t work.</p>
<p>We can’t completely prevent React users from misconfiguring their bundlers, but we introduced a few additional checks for this in .</p>
<p>If the development bundle executes, :</p>
<br>

  <a class="gatsby-resp-image-link" href="/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-1e9b4.png" style="display: block" target="_blank" rel="noopener">
  
  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 600px; margin-left: auto; margin-right: auto;">
    <span class="gatsby-resp-image-background-image" style="padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA7ElEQVQY05WQDWuDMBCG8///VQvCSIzxI9n8qEtiurmaqFFHwc3pUsZKYYyxh+N477gX7g68/x+tdSs593bgz9GPHyzLcn6dzoMFNGEQwiShaZr6GDNGaXIBQkQIYYwFJKRJjHEgxUHXqTOv6+rytm0gzwtVVZzzsiyLIldKHY9PnD9KIZ0uioMQQlXKDWRZJqvKNZ3W2lzMb78wz/OtuJZX3EXA8zy3XoD9OKToLnSBYRSFaUTu4/CBYLLf77DvI4QR8t0tUqjtG9Ca1lo7jmNnBtMMTW2bF3uqe6dPz33X2S+Mafu+n6bp9nOfEzOCGSCp8RoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;">
      <img class="gatsby-resp-image-image" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;" alt="React DevTools on a website with development version of React" title="" src="/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-1e9b4.png" srcset="/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-1cd08.png 210w,
/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-9b07a.png 420w,
/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-1e9b4.png 600w" sizes="(max-width: 600px) 100vw, 600px">
    </span>
  </span>
  
  </a>
    
<p>There is also one more bad scenario. Sometimes, <code>process.env.NODE_ENV</code> is set to <code>"production"</code> at runtime rather than at the build time. This is how it should work in Node.js, but it is bad for the client-side builds because the unnecessary development code is bundled even though it never executes. This is harder to detect but we found a heuristic that works well in most cases and doesn’t seem to produce false positives.</p>
<p>We can write a function that contains a  from React DevTools in the hope that it will be picked up by the error analytics.</p>
<p>We recognize this approach is somewhat fragile. The <code>toString()</code> method is not reliable and may change its behavior in future browser versions. This is why we put that logic into React DevTools itself rather than into React. This allows us to remove it later if it becomes problematic. We also warn only if we <em>found</em> the special string literal rather than if we <em>didn’t</em> find it. This way, if the <code>toString()</code> output becomes opaque, or is overriden, the warning just won’t fire.</p>
<h2 id="catching-mistakes-early">Catching Mistakes Early</h2>
<p>We want to catch bugs as early as possible. However, even with our extensive test coverage, occasionally we make a blunder. We made several changes to our build and test infrastructure this year to make it harder to mess up.</p>
<h3 id="migrating-to-es-modules">Migrating to ES Modules</h3>
<p>With the CommonJS <code>require()</code> and <code>module.exports</code>, it is easy to import a function that doesn’t really exist, and not realize that until you call it. However, tools like Rollup that natively support  to the ES Modules syntax.</p>
<p>Not only did this provide some extra protection, but it also helped improve the build size. Many React modules only export utility functions, but CommonJS forced us to wrap them into an object. By turning those utility functions into named exports and eliminating the objects that contained them, we let Rollup place them into the top-level scope, and thus let the minifier mangle their names in the production builds.</p>
<p>For now, have decided to only convert the source code to ES Modules, but not the tests. We use powerful utilities like <code>jest.resetModules()</code> and want to retain tighter control over when the modules get intialized in tests. In order to consume ES Modules from our tests, we enabled the , but only for the test environment.</p>
<h3 id="running-tests-in-production-mode">Running Tests in Production Mode</h3>
<p>Historically, we’ve been running all tests in a development environment. This let us assert on the warning messages produced by React, and seemed to make general sense. However, even though we try to keep the differences between the development and production code paths minimal, occasionally we would make a mistake in production-only code branches that weren’t covered by tests, and cause an issue at Facebook.</p>
<p>To solve this problem, we have added a new  as part of the production test run.</p>
<h3 id="using-public-api-in-tests">Using Public API in Tests</h3>
<p>When we were , we recognized the importance of writing tests against the public API instead of internal modules. If the test is written against the public API, it is clear what is being tested from the user’s perspective, and you can run it even if you rewrite the implementation from scratch.</p>
<p>We reached out to the wonderful React community  converting the remaining tests to use the public API. Almost all of the tests are converted now! The process wasn’t easy. Sometimes a unit test just calls an internal method, and it’s hard to figure out what the observable behavior from user’s point of view was supposed to be tested. We found a few strategies that helped with this. The first thing we would try is to find the git history for when the test was added, and find clues in the issue and pull request description. Often they would contain reproducing cases that ended up being more valuable than the original unit tests! A good way to verify the guess is to try commenting out individual lines in the source code being tested. If the test fails, we know for sure that it stresses the given code path.</p>
<p>We would like to give our deepest thanks to .</p>
<h3 id="running-tests-on-compiled-bundles">Running Tests on Compiled Bundles</h3>
<p>There is also one more benefit to writing tests against the public API: now we can .</p>
<p>This helps us ensure that tools like Babel, Rollup, and Google Closure Compiler don’t introduce any regressions. This also opens the door for future more aggressive optimizations, as we can be confident that React still behaves exactly as expected after them.</p>
<p>To implement this, we have created a . It overrides our default config but points <code>react</code>, <code>react-dom</code>, and other entry points to the <code>/build/packages/</code> folder. This folder doesn’t contain any React source code, and reflects what gets published to npm. It is populated after you run <code>yarn build</code>.</p>
<p>This lets us run the same exact tests that we normally run against the source, but execute them using both development and production pre-built React bundles produced with Rollup and Google Closure Compiler.</p>
<p>Unlike the normal test run, the bundle test run depends on the build products so it is not great for quick iteration. However, it still runs on the CI server so if something breaks, the test will display as failed, and we will know it’s not safe to merge into master.</p>
<p>There are still some test files that we intentionally don’t run against the bundles. Sometimes we want to mock an internal module or override a feature flag that isn’t exposed to the public yet. For those cases, we blacklist a test file by renaming it from <code>MyModule-test.js</code> to <code>MyModule-test.internal.js</code>.</p>
<p>Currently, over 93% out of 2,650 React tests run against the compiled bundles.</p>
<h3 id="linting-compiled-bundles">Linting Compiled Bundles</h3>
<p>In addition to linting our source code, we run a much more limited set of lint rules (really,  that the bundles don’t use any language features that aren’t supported by older browsers.</p>
<h3 id="simulating-package-publishing">Simulating Package Publishing</h3>
<p>Even running the tests on the built packages is not enough to avoid shipping a broken update. For example, we use the <code>files</code> field in our <code>package.json</code> files to specify a whitelist of folders and files that should be published on npm. However, it is easy to add a new entry point to a package but forget to add it to the whitelist. Even the bundle tests would pass, but after publishing the new entry point would be missing.</p>
<p>To avoid situations like this, we are now simulating the npm publish by  after the build. Just like <code>npm publish</code>, this command filters out anything that isn’t in the <code>files</code> whitelist. With this approach, if we were to forget adding an entry point to the list, it would be missing in the build folder, and the bundle tests relying on it would fail.</p>
<h3 id="creating-manual-test-fixtures">Creating Manual Test Fixtures</h3>
<p>Our unit tests run only in the Node environment, but not in the browsers. This was an intentional decision because browser-based testing tools were flaky in our experience, and didn’t catch many issues anyway.</p>
<p>We could get away with this because the code that touches the DOM is consolidated in a few files, and doesn’t change that often. Every week, we update the Facebook.com codebase to the latest React commit on master. At Facebook, we use a set of internal  tests for critical product workflows, and these catch some regressions. React updates are first delivered to employees, so severe bugs get reported immediately before they reach two billion users.</p>
<p>Still, it was hard to review DOM-related changes, and occasionally we would make mistakes. In particular, it was hard to remember all the edge cases that the code had to handle, why they were added, and when it was safe to remove them. We considered adding some automatic tests that run in the browser but we didn’t want to slow down the development cycle and deal with a fragile CI. Additionally, automatic tests don’t always catch DOM issues. For example, an input value displayed by the browser may not match what it reports as a DOM property.</p>
<p>We’ve chatted about this with  over the year.</p>
<p>These fixtures are implemented as a React app located in :</p>
<img src="https://user-images.githubusercontent.com/590904/33555298-dd52fb4e-d8cd-11e7-80e9-8369538eb633.png" style="max-width:100%" alt="DOM fixture example">
<p>The fixture app lets you choose a version of React (local or one of the published versions) which is handy for comparing the behavior before and after the changes. When we change the behavior related to how we interact with the DOM, we can verify that it didn’t regress by going through the related fixtures in different browsers.</p>
<p>In some cases, a change proved to be so complex that it necessitated a standalone purpose-built fixture to verify it. For example, the  that renders all supported attributes and their misspellings with previous and next version of React, and displays the differences. It took a few iterations (the key insight was to group attributes with similar behavior together) but it ultimately allowed us to fix all major issues in just a few days.</p>
<br>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">We went through the table to vet the new behavior for every case (and discovered some old bugs too) </blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Going through the fixtures is still a lot of work, and we are considering automating some of it. Still, the fixture app is invaluable even as documentation for the existing behavior and all the edge cases and browser bugs that React currently handles. Having it gives us confidence in making significant changes to the logic without breaking important use cases. Another improvement we’re considering is to have a GitHub bot build and deploy the fixtures automatically for every pull request that touches the relevant files so anyone can help with browser testing.</p>
<h3 id="preventing-infinite-loops">Preventing Infinite Loops</h3>
<p>The React 16 codebase contains many <code>while</code> loops. They let us avoid the dreaded deep stack traces that occurred with earlier versions of React, but can make development of React really difficult. Every time there is a mistake in an exit condition our tests would just hang, and it took a while to figure out which of the loops is causing the issue.</p>
<p>Inspired by the  in the test environment. If some loop continues for more than the maximum allowed number of iterations, we throw an error and immediately fail it so that Jest can display where exactly this happened.</p>
<p>This approach has a pitfall. If an error thrown from the Babel plugin gets caught and ignored up the call stack, the test will pass even though it has an infinite loop. This is really, really bad. To solve this problem, we . This way any infinite loop will cause a test failure, no matter whether the error from the Babel plugin was caught or not.</p>
<h2 id="customizing-the-build">Customizing the Build</h2>
<p>There were a few things that we had to fine-tune after introducing our new build process. It took us a while to figure them out, but we’re moderately happy with the solutions that we arrived at.</p>
<h3 id="dead-code-elimination">Dead Code Elimination</h3>
<p>The combination of Rollup and Google Closure Compiler already gets us pretty far in terms of stripping development-only code in production bundles. We  the <code>__DEV__</code> literal with a boolean constant during the build, and both Rollup together and Google Closure Compiler can strip out the <code>if (false) {}</code> code branches and even some more sophisticated patterns. However, there is one particularly nasty case:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code><span class="token keyword">import</span> warning <span class="token keyword">from</span> <span class="token string">'fbjs/lib/warning'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>__DEV__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">warning</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'Blimey!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>This pattern is very common in the React source code. However <code>fbjs/lib/warning</code> is an external import that isn’t being bundled by Rollup for the CommonJS bundle. Therefore, even if <code>warning()</code> call ends up being removed, Rollup doesn’t know whether it’s safe to remove to the import itself. What if the module performs a side effect during initialization? Then removing it would not be safe.</p>
<p>To solve this problem, we use the  which takes an array of modules that we can guarantee don’t have side effects. This lets Rollup know that an import to <code>fbjs/lib/warning</code> is safe to completely strip out if its value is not being used. However, if it <em>is</em> being used (e.g. if we decide to add warnings in production), the import will be preserved. That’s why this approach is safer than replacing modules with empty shims.</p>
<p>When we optimize something, we need to ensure it doesn’t regress in the future. What if somebody introduces a new development-only import of an external module, and not realize they also need to add it to <code>pureExternalModules</code>? Rollup prints a warning in such cases but we’ve  every time.</p>
<h3 id="forking-modules">Forking Modules</h3>
<p>In some cases, different bundles need to contain slightly different code. For example, React Native bundles have a different error handling mechanism that shows a redbox instead of printing a message to the console. However, it can be very inconvenient to thread these differences all the way through the calling modules.</p>
<p>Problems like this are often solved with runtime configuration. However, sometimes it is impossible: for example, the React DOM bundles shouldn’t even attempt to import the React Native redbox helpers. It is also unfortunate to bundle the code that never gets used in a particular environment.</p>
<p>Another solution is to use dynamic dependency injection. However, it often produces code that is hard to understand, and may cause cyclical dependencies. It also defies some optimization opportunities.</p>
<p>From the code point of view, ideally we just want to “redirect” a module to its different “forks” for specific bundles. The “forks” have the exact same API as the original modules, but do something different. We found this mental model very intuitive, and  that specifies how the original modules map to their forks, and the conditions under which this should happen.</p>
<p>For example, this fork config entry specifies different  for different bundles:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code><span class="token string">'shared/ReactFeatureFlags'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>bundleType<span class="token punctuation">,</span> entry<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>entry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'react-native-renderer'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token string">'shared/forks/ReactFeatureFlags.native.js'</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'react-cs-renderer'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token string">'shared/forks/ReactFeatureFlags.native-cs.js'</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>bundleType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> FB_DEV<span class="token punctuation">:</span>
        <span class="token keyword">case</span> FB_PROD<span class="token punctuation">:</span>
          <span class="token keyword">return</span> <span class="token string">'shared/forks/ReactFeatureFlags.www.js'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p>During the build,  to point the module to the appropriate forked version.</p>
<p>As a bonus, we might want to verify that the export types of the original modules match the export types of the forks exactly. We can use a  to accomplish this:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code><span class="token keyword">import</span> <span class="token keyword">typeof</span> <span class="token operator">*</span> <span class="token keyword">as</span> FeatureFlagsType <span class="token keyword">from</span> <span class="token string">'shared/ReactFeatureFlags'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">typeof</span> <span class="token operator">*</span> <span class="token keyword">as</span> FeatureFlagsShimType <span class="token keyword">from</span> <span class="token string">'./ReactFeatureFlags.native'</span><span class="token punctuation">;</span>
type Check<span class="token operator">&lt;</span>_X<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> _X<span class="token punctuation">,</span> X<span class="token punctuation">:</span> Y <span class="token operator">=</span> _X<span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">:</span> Check<span class="token operator">&lt;</span>FeatureFlagsShimType<span class="token punctuation">,</span> FeatureFlagsType<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>This works by essentially forcing Flow to verify that two types are assignable to each other (and thus are equivalent). Now if we modify the exports of either the original module or the fork without changing the other file, the type check will fail. This might be a little goofy but we found this helpful in practice.</p>
<p>To conclude this section, it is important to note that you can’t specify your own module forks if you consume React from npm. This is intentional because none of these files are public API, and they are not covered by the  guarantees. However, you are always welcome to build React from master or even fork it if you don’t mind the instability and the risk of divergence. We hope that this writeup was still helpful in documenting one possible approach to targeting different environments from a single JavaScript library.</p>
<h3 id="tracking-bundle-size">Tracking Bundle Size</h3>
<p>As a final build step, we now . When you run <code>yarn build</code>, it prints a table with the results:</p>
<br>
<img src="https://user-images.githubusercontent.com/1519870/28427900-80487dbc-6d6f-11e7-828d-1b594bd1ddb5.png" style="max-width:100%" alt="Build results after running GCC">
<p><em>(It doesn’t always look as good as this. This was the commit that migrated React from Uglify to Google Closure Compiler.)</em></p>
<p>Keeping the file sizes committed for everyone to see was helpful for tracking size changes and motivating people to find optimization opportunities.</p>
<p>We haven’t been entirely happy with this strategy because the JSON file often causes merge conflicts on larger branches. Updating it is also not currently enforced so it gets out of date. In the future, we’re considering integrating a bot that would comment on pull requests with the size changes.</p>
<h2 id="simplifying-the-release-process">Simplifying the Release Process</h2>
<p>We like to release updates to the open source community often. Unfortunately, the old process of creating a release was slow and would typically take an entire day. After some changes to this process, we’re now able to do a full release in less than an hour. Here’s what we changed.</p>
<h3 id="branching-strategy">Branching Strategy</h3>
<p>Most of the time spent in the old release process was due to our branching strategy. The <code>master</code> branch was assumed to be unstable and would often contain breaking changes. Releases were done from a <code>stable</code> branch, and changes were manually cherry-picked into this branch prior to a release. We had .</p>
<p>As of version 16, we now release from the <code>master</code> branch. Experimental features and breaking changes are allowed, but must be hidden behind  so they can be removed during the build process. The new flat bundles and dead code elimination make it possible for us to do this without fear of leaking unwanted code into open source builds.</p>
<h3 id="automated-scripts">Automated Scripts</h3>
<p>After changing to a stable <code>master</code>, we created a new . Although much simpler than the previous process, this still involved dozens of steps and forgetting one could result in a broken release.</p>
<p>To address this, we created a new  and has several built-in checks to ensure that we release a working build. The new process is split into two steps: <em>build</em> and <em>publish</em>. Here’s what it looks like the first time you run it:</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-a0a5f.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 822px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 45.37712895377128%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAA4ElEQVQoz52S227DIAyGU3JogRAICQdpKR2EoVzk/Z9vf9ObXkxbtE/IsrCwf9tU8zxbY8dx1FpLKWfn4ZvZjErVdV39zk0banz/8YDD/XJV+kJIdZL6RknTdkK2/YDTUF6dh3NurRPDAP3qoOu6s49DeHDGqv9hjMk5L8sdNZGolLLv+7Zta0oxxs8YU0pSKmvtD4/zmr3zPeD8esAYo5T+PWrQtt1rT+j5ckAIgUUIVgiBEKxzrmma1/3bqijNeYXgEAJ0QohS2LFCRtSfpincEQnlqzx7WROmqw/wKb4BarITYyj4QEYAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Release Script overview"
        title=""
        src="/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-a0a5f.png"
        srcset="/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-d0a04.png 210w,
/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-c8d6c.png 420w,
/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-a0a5f.png 822w"
        sizes="(max-width: 822px) 100vw, 822px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>The <em>build</em> step does most of the work- verifying permissions, running tests, and checking CI status. Once it finishes, it prints a reminder to update the CHANGELOG and to verify the bundle using the  described above.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-d15b8.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 840px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 95.52407932011332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsSAAALEgHS3X78AAABlUlEQVQ4y5VTa2+sIBRc9yWKgjwVFMXV5qbJ7f//ex0xt19u624nhiA5E+bMGU7KKN/7GM00mbbr2raVUlJK67ouyzLPc5KT+/1++hbam8eyrOsaQgDh9CsII/phGELo+15pfT6ff0FWnR7HEXTOOaUVYwxqq6q6Xq+vkud51loLIfZWQX5Jwia7H5xz1racN2AWRYH7wadVBcOOyLWo4bC11rlGSl4mgLmvt9vtiFzokkiSizzLMvxmCWlz/tr/CPiEa7sEmyQYY9E/zpumYYwfNY88oEOealnC7hlJeGJbnoA6rCWlO2c/wbSeyIZOhMR5h2l57ykt85/C+D/QGMarE1JO6OVyyf5htxAr9H+jApGOcca6LMuw7SMkqARjjJRWyEGpKMQg5ESIIoXGR6u+KM0JRbvVKEVIX0rlF2Bv16kQxPIw62qVItYWUhLGCDxHF0dktOp9H6N/e3N/P6b39xXi8Uhh3pNsAnj6xgalg22Xzv2x7cOYeevnFSDS46hi1NO0+T3AF8mM4dvDwNwoPbj/E0RsJqoTdg3PAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Release Script build confirmation screen"
        title=""
        src="/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-acf85.png"
        srcset="/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-c1418.png 210w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-5d5d8.png 420w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-acf85.png 840w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-de0cd.png 1260w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-bd6c2.png 1680w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-d15b8.png 1765w"
        sizes="(max-width: 840px) 100vw, 840px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>All that’s left is to tag and publish the release to NPM using the <em>publish</em> script.</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-bd35c.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 840px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 125.12733446519523%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsSAAALEgHS3X78AAACY0lEQVQ4y5WUaY+bMBCG06RJANtAgMQGmyOQa4+q+6X9/z+tj6GHEu1q6SuExsdc78x4cTCHY98fj33bNsCB2v/SNM2yjH8OCg+lZBAEaeKxWi05WshMcr2qKmOMNuagtVJqtVot5mArtrvdLsvzldgvVBXKBE+LmRC1jCrBJxsZFMHivzDlRlo4JOx0tyOlOI7zLGefVMdlIqWsbEWM6/X6nzL3uBSGIQdRFG2327kJA3T2+z0msI2MfynVyIIPR2vjN4sCu8vl8lEZbok8igTOkbHCvUkAuyybZExzgaMvD8rYFkJwwiUyjLzgFRJf5CJWik01GqXOd56xJ4RPdbPZhGHAchTCyc9fh8EIhDvCSHKiN0nSZPRGIJDsd+L4E8JOpxO9NZw8Xl5eaNXb09NjeB+BeyQ2OSQEDIVhJlWt4pZPxg3/JD2xI2Sl4k4qF0aHP6XKsuv1ej6fn56f69oNw6lp28vl0g/dzx/1+ZxoHX7oGbats34wSqbi4Gp9uRRNI/M8oPy0gNaRMVFRBEJIQqOjpJK/leGWXSidOpHbMD+3w+CpNOb19Vvvp/rIchiGrutIhOVdYd4NuyxLP/6uGAbT92XdDNo4Uz4naTfRNlLF324298Wjnngg5uPRXa+dcwdr8763TVOTy5xS5WoECftAqtJaOzvnshwz7JF5xm6321zC6FxtNDwz+23baq2xhQlog8JpvAEBfl2vH0edlm67DgU0v7+94ZyYaXQqX46ASescnVdZi+k7ZZ5O5hknJOzqGvLomblhM3QQNj5j+fSSwBkvmn+d03R6EhDf7Zxfl+pFob7eDqUAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Release Script publish confirmation screen"
        title=""
        src="/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-acf85.png"
        srcset="/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-c1418.png 210w,
/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-5d5d8.png 420w,
/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-acf85.png 840w,
/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-bd35c.png 1178w"
        sizes="(max-width: 840px) 100vw, 840px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>(You may have noticed a <code>--dry</code> flag in the screenshots above. This flag allows us to run a release, end-to-end, without actually publishing to NPM. This is useful when working on the release script itself.)</p>
<h2 id="in-conclusion">In Conclusion</h2>
<p>Did this post inspire you to try some of these ideas in your own projects? We certainly hope so! If you have other ideas about how React build, test, or contribution workflow could be improved, please let us know on .</p>
<p>You can find the related issues by the . These are often great first contribution opportunities!</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>We would like to thank:</p>
<ul>
<li> for maintaining Rollup and helping us integrate it.</li>
<li> for their work on Google Closure Compiler and timely advice.</li>
<li>, and others for helping prototype and implement some of these and other improvements.</li>
<li>, <a href="https://github.com/enapupe">Iacami Gevaerd
</a>, , and others for their help porting the React test suite to use the public API.</li>
</ul>
---------------